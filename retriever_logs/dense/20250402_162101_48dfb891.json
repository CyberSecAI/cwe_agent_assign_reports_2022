{
  "retriever": "dense",
  "query": "## Vulnerability Description\nThis vulnerability allows remote attackers to execute arbitrary code on affected installations of Foxit Reader 10.1.1.37576. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file. The specific flaw exists within the handling of U3D objects in PDF files. The issue results from the **lack of proper validation of user-supplied data**, which can result in a **write past the end of an allocated data structure**. An attacker can leverage this vulnerability to execute code in the context of the current process. Was ZDI-CAN-13011.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **lack of proper validation of user-supplied data**\n- **weakness:** **write past the end of an allocated data structure**\n- **impact:** execute arbitrary code\n- **vector:** malicious page or file\n- **attacker:** remote attackers\n- **product:** Foxit Reader\n- **version:** 10.1.1.37576\n- **component:** U3D objects in PDF files\n\n### CWE for similar CVE Descriptions\n### Primary CWE Match\nCWE-125\n\n#### Top CWEs\n- CWE-125 (Count: 257)\n- CWE-787 (Count: 233)\n- CWE-416 (Count: 222)\n\n## CVE Reference Links Content Summary\n```\n{\n  \"guid\": \"CVE-2021-31472\",\n  \"related_cves\": [\n     \"CVE-2024-12751\",\n     \"CVE-2024-12752\",\n     \"CVE-2024-12753\",\n     \"CVE-2024-49576\",\n     \"CVE-2024-47810\",\n     \"CVE-2024-28888\",\n     \"CVE-2024-7725\",\n     \"CVE-2024-9254\",\n    \"CVE-2024-7722\",\n    \"CVE-2024-7723\",\n    \"CVE-2024-7724\",\n     \"CVE-2024-9243\",\n    \"CVE-2024-9246\",\n    \"CVE-2024-9250\",\n    \"CVE-2024-9252\",\n    \"CVE-2024-9253\",\n    \"CVE-2024-9251\",\n    \"CVE-2024-9255\",\n    \"CVE-2024-9256\",\n    \"CVE-2024-9245\",\n    \"CVE-2024-9244\",\n    \"CVE-2024-38393\",\n    \"CVE-2024-48618\",\n    \"CVE-2024-9247\",\n    \"CVE-2024-9249\",\n    \"CVE-2024-9248\",\n    \"CVE-2024-41605\",\n    \"CVE-2024-7722\",\n      \"CVE-2024-25938\",\n    \"CVE-2024-25648\",\n      \"CVE-2024-25575\",\n    \"CVE-2024-30324\",\n    \"CVE-2024-30327\",\n    \"CVE-2024-30328\",\n    \"CVE-2024-30331\",\n    \"CVE-2024-30336\",\n    \"CVE-2024-30342\",\n    \"CVE-2024-30343\",\n    \"CVE-2024-30344\",\n    \"CVE-2024-30345\",\n    \"CVE-2024-30346\",\n    \"CVE-2024-30351\",\n    \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n    \"CVE-2024-30363\",\n        \"CVE-2024-30361\",\n    \"CVE-2024-30362\",\n     \"CVE-2024-30354\",\n    \"CVE-2024-30365\",\n    \"CVE-2024-30366\",\n    \"CVE-2024-25858\",\n      \"CVE-2024-30322\",\n      \"CVE-2024-30325\",\n      \"CVE-2024-30326\",\n      \"CVE-2024-30329\",\n      \"CVE-2024-30330\",\n      \"CVE-2024-30332\",\n      \"CVE-2024-30333\",\n      \"CVE-2024-30334\",\n      \"CVE-2024-30335\",\n    \"CVE-2024-30337\",\n      \"CVE-2024-30338\",\n        \"CVE-2024-30339\",\n    \"CVE-2024-30340\",\n      \"CVE-2024-30347\",\n    \"CVE-2024-30350\",\n        \"CVE-2024-30352\",\n    \"CVE-2024-30353\",\n      \"CVE-2024-30355\",\n          \"CVE-2024-30358\",\n        \"CVE-2024-30349\",\n      \"CVE-2024-30364\",\n     \"CVE-2024-30367\",\n    \"CVE-2024-30371\",\n       \"CVE-2024-30323\",\n    \"CVE-2024-30360\",\n    \"CVE-2024-32488\",\n    \"CVE-2024-30356\",\n   \"CVE-2023-51549\",\n      \"CVE-2023-51550\",\n    \"CVE-2023-51552\",\n    \"CVE-2023-51554\",\n       \"CVE-2023-51553\",\n    \"CVE-2023-32616\",\n     \"CVE-2023-41257\",\n    \"CVE-2023-38573\",\n     \"CVE-2023-51555\",\n    \"CVE-2023-51556\",\n    \"CVE-2023-51557\",\n    \"CVE-2023-51558\",\n      \"CVE-2023-51559\",\n    \"CVE-2023-51551\",\n    \"CVE-2023-51562\",\n    \"CVE-2023-40194\",\n    \"CVE-2023-35985\",\n    \"CVE-2023-51560\",\n      \"CVE-2023-42089\",\n        \"CVE-2023-42090\",\n          \"CVE-2023-42091\",\n      \"CVE-2023-42092\",\n      \"CVE-2023-42093\",\n        \"CVE-2023-42094\",\n        \"CVE-2023-42095\",\n          \"CVE-2023-42096\",\n        \"CVE-2023-42097\",\n        \"CVE-2023-42098\",\n     \"CVE-2023-39542\",\n         \"CVE-2023-51561\",\n            \"CVE-2023-27363\",\n     \"CVE-2023-27364\",\n    \"CVE-2023-27365\",\n    \"CVE-2023-27366\",\n        \"CVE-2024-29072\",\n    \"CVE-2024-30324\",\n        \"CVE-2024-30327\",\n    \"CVE-2024-30328\",\n    \"CVE-2024-30331\",\n    \"CVE-2024-30336\",\n    \"CVE-2024-30342\",\n    \"CVE-2024-30343\",\n    \"CVE-2024-30344\",\n    \"CVE-2024-30345\",\n    \"CVE-2024-30346\",\n    \"CVE-2024-30351\",\n    \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n    \"CVE-2024-30363\",\n        \"CVE-2024-30361\",\n    \"CVE-2024-30362\",\n     \"CVE-2024-30354\",\n    \"CVE-2024-30365\",\n    \"CVE-2024-30366\",\n     \"CVE-2024-30322\",\n      \"CVE-2024-30325\",\n      \"CVE-2024-30326\",\n      \"CVE-2024-30329\",\n      \"CVE-2024-30330\",\n      \"CVE-2024-30332\",\n      \"CVE-2024-30333\",\n      \"CVE-2024-30334\",\n      \"CVE-2024-30335\",\n        \"CVE-2024-30337\",\n        \"CVE-2024-30338\",\n        \"CVE-2024-30339\",\n            \"CVE-2024-30340\",\n        \"CVE-2024-30341\",\n            \"CVE-2024-30347\",\n    \"CVE-2024-30350\",\n        \"CVE-2024-30352\",\n    \"CVE-2024-30353\",\n      \"CVE-2024-30355\",\n      \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n      \"CVE-2024-30358\",\n        \"CVE-2024-30349\",\n    \"CVE-2024-30360\",\n          \"CVE-2024-30364\",\n        \"CVE-2024-30367\",\n    \"CVE-2024-30371\",\n  \"CVE-2023-38105\",\n   \"CVE-2023-38106\",\n  \"CVE-2023-38108\",\n    \"CVE-2023-38116\",\n    \"CVE-2023-38119\",\n    \"CVE-2023-38118\",\n        \"CVE-2023-28744\",\n    \"CVE-2023-38111\",\n    \"CVE-2023-38107\",\n    \"CVE-2023-38109\",\n     \"CVE-2023-38113\",\n    \"CVE-2023-38114\",\n      \"CVE-2023-38112\",\n      \"CVE-2023-38110\",\n        \"CVE-2023-38115\",\n      \"CVE-2023-38117\",\n    \"CVE-2023-27379\",\n    \"CVE-2023-33866\",\n   \"CVE-2023-32664\",\n   \"CVE-2023-33876\",\n   \"CVE-2024-25938\",\n   \"CVE-2024-25648\",\n   \"CVE-2024-25575\",\n       \"CVE-2024-25858\",\n   \"CVE-2024-30322\",\n    \"CVE-2024-30324\",\n     \"CVE-2024-30325\",\n        \"CVE-2024-30326\",\n        \"CVE-2024-30327\",\n    \"CVE-2024-30328\",\n    \"CVE-2024-30329\",\n        \"CVE-2024-30330\",\n     \"CVE-2024-30331\",\n     \"CVE-2024-30332\",\n     \"CVE-2024-30333\",\n     \"CVE-2024-30334\",\n      \"CVE-2024-30335\",\n    \"CVE-2024-30336\",\n    \"CVE-2024-30337\",\n     \"CVE-2024-30338\",\n      \"CVE-2024-30339\",\n     \"CVE-2024-30340\",\n    \"CVE-2024-30342\",\n        \"CVE-2024-30343\",\n    \"CVE-2024-30344\",\n    \"CVE-2024-30345\",\n        \"CVE-2024-30346\",\n     \"CVE-2024-30347\",\n    \"CVE-2024-30350\",\n      \"CVE-2024-30351\",\n     \"CVE-2024-30352\",\n    \"CVE-2024-30353\",\n     \"CVE-2024-30355\",\n     \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n    \"CVE-2024-30358\",\n     \"CVE-2024-30349\",\n    \"CVE-2024-30363\",\n     \"CVE-2024-30364\",\n    \"CVE-2024-30367\",\n      \"CVE-2024-30371\",\n            \"CVE-2024-30323\",\n        \"CVE-2024-30360\",\n         \"CVE-2024-30361\",\n     \"CVE-2024-30362\",\n    \"CVE-2024-30341\",\n     \"CVE-2024-30354\",\n       \"CVE-2024-30359\",\n    \"CVE-2024-30365\",\n    \"CVE-2024-30366\",\n   \"CVE-2024-25938\",\n   \"CVE-2024-25648\",\n    \"CVE-2024-25575\",\n  \"CVE-2024-29072\",\n  \"CVE-2024-28888\",\n      \"CVE-2024-7722\",\n    \"CVE-2024-7723\",\n    \"CVE-2024-7724\",\n     \"CVE-2024-7725\",\n   \"CVE-2024-9243\",\n    \"CVE-2024-9246\",\n    \"CVE-2024-9250\",\n        \"CVE-2024-9252\",\n    \"CVE-2024-9253\",\n    \"CVE-2024-9251\",\n        \"CVE-2024-9254\",\n    \"CVE-2024-9255\",\n    \"CVE-2024-9256\",\n     \"CVE-2024-9245\",\n    \"CVE-2024-9244\",\n     \"CVE-2024-38393\",\n    \"CVE-2024-48618\",\n   \"CVE-2024-9247\",\n      \"CVE-2024-9249\",\n    \"CVE-2024-9248\",\n     \"CVE-2024-41605\",\n      \"CVE-2024-12751\",\n     \"CVE-2024-12752\",\n    \"CVE-2024-49576\",\n        \"CVE-2024-47810\",\n      \"CVE-2024-12753\"\n\n\n  ],\n  \"root_cause\": \"The vulnerability is caused by a lack of proper validation of user-supplied data when handling U3D objects in PDF files, which results in a write past the end of an allocated data structure.\",\n  \"vulnerabilities\": [\n    \"Out-of-Bounds Write\"\n  ],\n  \"impact\": \"An attacker can leverage this vulnerability to execute code in the context of the current process.\",\n  \"attack_vectors\": [\n    \"The target must visit a malicious page or open a malicious file.\"\n  ],\n  \"attacker_capabilities\": \"The attacker needs to craft a malicious PDF file with a malformed U3D object.\",\n  \"additional_information\": \"Foxit has issued an update to correct this vulnerability. More details can be found at:\"\n}\n```\n\n## Retriever Results\n\n### Top Combined Results\n\n| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |\n|------|--------|------|-------------|-------|------------|-------------------|\n| 1 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.746 |\n| 2 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.705 |\n| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.643 |\n| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.639 |\n| 5 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.629 |\n| 6 | 356 | Product UI does not Warn User of Unsafe Actions | Base | Allowed | dense | 0.562 |\n| 7 | 125 | Out-of-bounds Read | Base | Allowed | graph | 0.002 |\n| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.614 |\n| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.611 |\n| 10 | 788 | Access of Memory Location After End of Buffer | Base | Discouraged | sparse | 0.597 |\n\n\n\n# Complete CWE Specifications\n\n\n## CWE-787: Out-of-bounds Write\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product writes data past the end, or before the beginning, of the intended buffer.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nMemory Corruption: Often used to describe the consequences of writing to memory outside the bounds of a buffer, or to memory that is otherwise invalid.\n\n### Relationships\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2023-1017:** The reference implementation code for a Trusted Platform Module does not implement length checks on data, allowing for an attacker to write 2 bytes past the end of a buffer.\n- **CVE-2021-21220:** Chain: insufficient input validation (CWE-20) in browser allows heap corruption (CWE-787), as exploited in the wild per CISA KEV.\n- **CVE-2021-28664:** GPU kernel driver allows memory corruption because a user can obtain read/write access to read-only pages, as exploited in the wild per CISA KEV.\n\n\n\n\n## CWE-20: Improper Input Validation\n**Abstraction:** Class\n**Status:** Stable\n\n### Description\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.\n\n### Extended Description\n\n\nInput validation is a frequently-used technique for checking potentially dangerous inputs in order to ensure that the inputs are safe for processing within the code, or when communicating with other components. When software does not validate input properly, an attacker is able to craft the input in a form that is not expected by the rest of the application. This will lead to parts of the system receiving unintended input, which may result in altered control flow, arbitrary control of a resource, or arbitrary code execution.\n\n\nInput validation is not the only technique for processing input, however. Other techniques attempt to transform potentially-dangerous input into something safe, such as filtering (CWE-790) - which attempts to remove dangerous inputs - or encoding/escaping (CWE-116), which attempts to ensure that the input is not misinterpreted when it is included in output to another component. Other techniques exist as well (see CWE-138 for more examples.)\n\n\nInput validation can be applied to:\n\n\n  - raw data - strings, numbers, parameters, file contents, etc.\n\n  - metadata - information about the raw data, such as headers or size\n\nData can be simple or structured. Structured data can be composed of many nested layers, composed of combinations of metadata and raw data, with other simple or structured data.\n\nMany properties of raw data or metadata may need to be validated upon entry into the code, such as:\n\n\n  - specified quantities such as size, length, frequency, price, rate, number of operations, time, etc.\n\n  - implied or derived quantities, such as the actual size of a file instead of a specified size\n\n  - indexes, offsets, or positions into more complex data structures\n\n  - symbolic keys or other elements into hash tables, associative arrays, etc.\n\n  - well-formedness, i.e. syntactic correctness - compliance with expected syntax \n\n  - lexical token correctness - compliance with rules for what is treated as a token\n\n  - specified or derived type - the actual type of the input (or what the input appears to be)\n\n  - consistency - between individual data elements, between raw data and metadata, between references, etc.\n\n  - conformance to domain-specific rules, e.g. business logic \n\n  - equivalence - ensuring that equivalent inputs are treated the same\n\n  - authenticity, ownership, or other attestations about the input, e.g. a cryptographic signature to prove the source of the data\n\nImplied or derived properties of data must often be calculated or inferred by the code itself. Errors in deriving properties may be considered a contributing factor to improper input validation. \n\nNote that \"input validation\" has very different meanings to different people, or within different classification schemes. Caution must be used when referencing this CWE entry or mapping to it. For example, some weaknesses might involve inadvertently giving control to an attacker over an input when they should not be able to provide an input at all, but sometimes this is referred to as input validation.\n\n\nFinally, it is important to emphasize that the distinctions between input validation and output escaping are often blurred, and developers must be careful to understand the difference, including how input validation is not always sufficient to prevent vulnerabilities, especially when less stringent data types must be supported, such as free-form text. Consider a SQL injection scenario in which a person's last name is inserted into a query. The name \"O'Reilly\" would likely pass the validation step since it is a common last name in the English language. However, this valid name cannot be directly inserted into the database because it contains the \"'\" apostrophe character, which would need to be escaped or otherwise transformed. In this case, removing the apostrophe might reduce the risk of SQL injection, but it would produce incorrect behavior because the wrong name would be recorded.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-707\nPeerOf -> CWE-345\nCanPrecede -> CWE-22\nCanPrecede -> CWE-41\nCanPrecede -> CWE-74\nCanPrecede -> CWE-119\nCanPrecede -> CWE-770\n\n### Mapping Guidance\n**Usage:** Discouraged\n**Rationale:** CWE-20 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available [REF-1287]. It is not useful for trend analysis. It is also a level-1 Class (i.e., a child of a Pillar).\n**Comments:** Consider lower-level children such as Improper Use of Validation Framework (CWE-1173) or improper validation involving specific types or properties of input such as Specified Quantity (CWE-1284); Specified Index, Position, or Offset (CWE-1285); Syntactic Correctness (CWE-1286); Specified Type (CWE-1287); Consistency within Input (CWE-1288); or Unsafe Equivalence (CWE-1289).\n**Reasons:**\n- Frequent Misuse\n**Suggested Alternatives:**\n- CWE-1284: Specified Quantity\n- CWE-1285: Specified Index, Position, or Offset\n- CWE-1286: Syntactic Correctness\n- CWE-1287: Specified Type\n- CWE-1288: Consistency within Input\n- CWE-1289: Unsafe Equivalence\n- CWE-116: Improper Encoding or Escaping of Output\n\n\n### Additional Notes\n**[Relationship]** \n\nCWE-116 and CWE-20 have a close association because, depending on the nature of the structured message, proper input validation can indirectly prevent special characters from changing the meaning of a structured message. For example, by validating that a numeric ID field should only contain the 0-9 characters, the programmer effectively prevents injection attacks.\n\n\n**[Maintenance]** As of 2020, this entry is used more often than preferred, and it is a source of frequent confusion. It is being actively modified for CWE 4.1 and subsequent versions.\n\n**[Maintenance]** Concepts such as validation, data transformation, and neutralization are being refined, so relationships between CWE-20 and other entries such as CWE-707 may change in future versions, along with an update to the Vulnerability Theory document.\n\n**[Maintenance]** Input validation - whether missing or incorrect - is such an essential and widespread part of secure development that it is implicit in many different weaknesses. Traditionally, problems such as buffer overflows and XSS have been classified as input validation problems by many security professionals. However, input validation is not necessarily the only protection mechanism available for avoiding such problems, and in some cases it is not even sufficient. The CWE team has begun capturing these subtleties in chains within the Research Concepts view (CWE-1000), but more work is needed.\n\n**[Terminology]** \n\nThe \"input validation\" term is extremely common, but it is used in many different ways. In some cases its usage can obscure the real underlying weakness or otherwise hide chaining and composite relationships.\n\n\nSome people use \"input validation\" as a general term that covers many different neutralization techniques for ensuring that input is appropriate, such as filtering, canonicalization, and escaping. Others use the term in a more narrow context to simply mean \"checking if an input conforms to expectations without changing it.\" CWE uses this more narrow interpretation.\n\n\n\n\n### Observed Examples\n- **CVE-2024-37032:** Large language model (LLM) management tool does not validate the format of a digest value (CWE-1287) from a private, untrusted model registry, enabling relative path traversal (CWE-23), a.k.a. Probllama\n- **CVE-2022-45918:** Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using \"../\" sequences (CWE-24)\n- **CVE-2021-30860:** Chain: improper input validation (CWE-20) leads to integer overflow (CWE-190) in mobile OS, as exploited in the wild per CISA KEV.\n\n\n\n\n## CWE-1284: Improper Validation of Specified Quantity in Input\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.\n\n### Extended Description\n\n\nSpecified quantities include size, length, frequency, price, rate, number of operations, time, and others. Code may rely on specified quantities to allocate resources, perform calculations, control iteration, etc. When the quantity is not properly validated, then attackers can specify malicious quantities to cause excessive resource allocation, trigger unexpected failures, enable buffer overflows, etc.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-20\nChildOf -> CWE-20\nCanPrecede -> CWE-789\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** This entry is still under development and will continue to see updates and content improvements.\n\n\n\n### Observed Examples\n- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).\n- **CVE-2008-1440:** lack of validation of length field leads to infinite loop\n- **CVE-2008-2374:** lack of validation of string length fields allows memory consumption or buffer over-read\n\n\n\n\n## CWE-122: Heap-based Buffer Overflow\n**Abstraction:** Variant\n**Status:** Draft\n\n### Description\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-788\nChildOf -> CWE-787\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** Heap-based buffer overflows are usually just as dangerous as stack-based buffer overflows.\n\n\n\n### Observed Examples\n- **CVE-2021-43537:** Chain: in a web browser, an unsigned 64-bit integer is forcibly cast to a 32-bit integer (CWE-681) and potentially leading to an integer overflow (CWE-190). If an integer overflow occurs, this can cause heap memory corruption (CWE-122)\n- **CVE-2007-4268:** Chain: integer signedness error (CWE-195) passes signed comparison, leading to heap overflow (CWE-122)\n- **CVE-2009-2523:** Chain: product does not handle when an input string is not NULL terminated (CWE-170), leading to buffer over-read (CWE-125) or heap-based buffer overflow (CWE-122).\n\n\n\n\n## CWE-121: Stack-based Buffer Overflow\n**Abstraction:** Variant\n**Status:** Draft\n\n### Description\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nStack Overflow: \"Stack Overflow\" is often used to mean the same thing as stack-based buffer overflow, however it is also used on occasion to mean stack exhaustion, usually a result from an excessively recursive function call. Due to the ambiguity of the term, use of stack overflow to describe either circumstance is discouraged.\n\n### Relationships\nChildOf -> CWE-788\nChildOf -> CWE-787\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Other]** Stack-based buffer overflows can instantiate in return address overwrites, stack pointer overwrites or frame pointer overwrites. They can also be considered function pointer overwrites, array indexer overwrites or write-what-where condition, etc.\n\n\n\n### Observed Examples\n- **CVE-2021-35395:** Stack-based buffer overflows in SFK for wifi chipset used for IoT/embedded devices, as exploited in the wild per CISA KEV.\n\n\n\n\n## CWE-356: Product UI does not Warn User of Unsafe Actions\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product's user interface does not warn the user before undertaking an unsafe action on behalf of that user. This makes it easier for attackers to trick users into inflicting damage to their system.\n\n### Extended Description\nProduct systems should warn users that a potentially dangerous action may occur if the user proceeds. For example, if the user downloads a file from an unknown source and attempts to execute the file on their machine, then the application's GUI can indicate that the file is unsafe.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-221\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** Often resultant, e.g. in unhandled error conditions.\n\n**[Relationship]** Can overlap privilege errors, conceptually at least.\n\n\n\n### Observed Examples\n- **CVE-1999-1055:** Product does not warn user when document contains certain dangerous functions or macros.\n- **CVE-1999-0794:** Product does not warn user when document contains certain dangerous functions or macros.\n- **CVE-2000-0277:** Product does not warn user when document contains certain dangerous functions or macros.\n\n\n\n\n## CWE-125: Out-of-bounds Read\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product reads data past the end, or before the beginning, of the intended buffer.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nOOB read: Shorthand for \"Out of bounds\" read\n\n### Relationships\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2023-1018:** The reference implementation code for a Trusted Platform Module does not implement length checks on data, allowing for an attacker to read 2 bytes past the end of a buffer.\n- **CVE-2020-11899:** Out-of-bounds read in IP stack used in embedded systems, as exploited in the wild per CISA KEV.\n- **CVE-2014-0160:** Chain: \"Heartbleed\" bug receives an inconsistent length parameter (CWE-130) enabling an out-of-bounds read (CWE-126), returning memory that could include private cryptographic keys and other sensitive data.\n\n\n\n\n## CWE-732: Incorrect Permission Assignment for Critical Resource\n**Abstraction:** Class\n**Status:** Draft\n\n### Description\nThe product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\n\n### Extended Description\nWhen a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution, or sensitive user data. For example, consider a misconfigured storage account for the cloud that can be read or written by a public or anonymous user.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-285\nChildOf -> CWE-668\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** While the name itself indicates an assignment of permissions for resources, this is often misused for vulnerabilities in which \"permissions\" are not checked, which is an \"authorization\" weakness (CWE-285 or descendants) within CWE's model [REF-1287].\n**Comments:** Closely analyze the specific mistake that is allowing the resource to be exposed, and perform a CWE mapping for that mistake.\n**Reasons:**\n- Frequent Misuse\n\n\n### Additional Notes\n**[Maintenance]** The relationships between privileges, permissions, and actors (e.g. users and groups) need further refinement within the Research view. One complication is that these concepts apply to two different pillars, related to control of resources (CWE-664) and protection mechanism failures (CWE-693).\n\n\n\n### Observed Examples\n- **CVE-2022-29527:** Go application for cloud management creates a world-writable sudoers file that allows local attackers to inject sudo rules and escalate privileges to root by winning a race condition.\n- **CVE-2009-3482:** Anti-virus product sets insecure \"Everyone: Full Control\" permissions for files under the \"Program Files\" folder, allowing attackers to replace executables with Trojan horses.\n- **CVE-2009-3897:** Product creates directories with 0777 permissions at installation, allowing users to gain privileges and access a socket used for authentication.\n\n\n\n\n## CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer\n**Abstraction:** Class\n**Status:** Stable\n\n### Description\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nBuffer Overflow: This term has many different meanings to different audiences. From a CWE mapping perspective, this term should be avoided where possible. Some researchers, developers, and tools intend for it to mean \"write past the end of a buffer,\" whereas others use the same term to mean \"any read or write outside the boundaries of a buffer, whether before the beginning of the buffer or after the end of the buffer.\" Others could mean \"any action after the end of a buffer, whether it is a read or write.\" Since the term is commonly used for exploitation and for vulnerabilities, it further confuses things.\nbuffer overrun: Some prominent vendors and researchers use the term \"buffer overrun,\" but most people use \"buffer overflow.\" See the alternate term for \"buffer overflow\" for context.\nmemory safety: Generally used for techniques that avoid weaknesses related to memory access, such as those identified by CWE-119 and its descendants. However, the term is not formal, and there is likely disagreement between practitioners as to which weaknesses are implicitly covered by the \"memory safety\" term.\n\n### Relationships\nChildOf -> CWE-118\nChildOf -> CWE-20\n\n### Mapping Guidance\n**Usage:** Discouraged\n**Rationale:** CWE-119 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available.\n**Comments:** Look at CWE-119's children and consider mapping to CWEs such as CWE-787: Out-of-bounds Write, CWE-125: Out-of-bounds Read, or others.\n**Reasons:**\n- Frequent Misuse\n\n\n### Additional Notes\n**[Applicable Platform]** \n\nIt is possible in any programming languages without memory management support to attempt an operation outside of the bounds of a memory buffer, but the consequences will vary widely depending on the language, platform, and chip architecture.\n\n\n\n\n### Observed Examples\n- **CVE-2021-22991:** Incorrect URI normalization in application traffic product leads to buffer overflow, as exploited in the wild per CISA KEV.\n- **CVE-2020-29557:** Buffer overflow in Wi-Fi router web interface, as exploited in the wild per CISA KEV.\n- **CVE-2009-2550:** Classic stack-based buffer overflow in media player using a long entry in a playlist\n\n\n\n\n## CWE-788: Access of Memory Location After End of Buffer\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product reads or writes to a buffer using an index or pointer that references a memory location after the end of the buffer.\n\n### Extended Description\nThis typically occurs when a pointer or its index is incremented to a position after the buffer; or when pointer arithmetic results in a position after the buffer.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\n\n### Mapping Guidance\n**Usage:** Discouraged\n**Rationale:** The CWE entry might be misused when lower-level CWE entries might be available. It also overlaps existing CWE entries and might be deprecated in the future.\n**Comments:** If the \"Access\" operation is known to be a read or a write, then investigate children of entries such as CWE-787: Out-of-bounds Write and CWE-125: Out-of-bounds Read.\n**Reasons:**\n- Potential Deprecation\n- Frequent Misuse\n\n\n\n### Observed Examples\n- **CVE-2009-2550:** Classic stack-based buffer overflow in media player using a long entry in a playlist\n- **CVE-2009-2403:** Heap-based buffer overflow in media player using a long entry in a playlist\n- **CVE-2009-0689:** large precision value in a format string triggers overflow\n\n",
  "keyphrases": {
    "base_query": "## Vulnerability Description\nThis vulnerability allows remote attackers to execute arbitrary code on affected installations of Foxit Reader 10.1.1.37576. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file. The specific flaw exists within the handling of U3D objects in PDF files. The issue results from the **lack of proper validation of user-supplied data**, which can result in a **write past the end of an allocated data structure**. An attacker can leverage this vulnerability to execute code in the context of the current process. Was ZDI-CAN-13011.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **lack of proper validation of user-supplied data**\n- **weakness:** **write past the end of an allocated data structure**\n- **impact:** execute arbitrary code\n- **vector:** malicious page or file\n- **attacker:** remote attackers\n- **product:** Foxit Reader\n- **version:** 10.1.1.37576\n- **component:** U3D objects in PDF files\n\n### CWE for similar CVE Descriptions\n### Primary CWE Match\nCWE-125\n\n#### Top CWEs\n- CWE-125 (Count: 257)\n- CWE-787 (Count: 233)\n- CWE-416 (Count: 222)\n\n## CVE Reference Links Content Summary\n```\n{\n  \"guid\": \"CVE-2021-31472\",\n  \"related_cves\": [\n     \"CVE-2024-12751\",\n     \"CVE-2024-12752\",\n     \"CVE-2024-12753\",\n     \"CVE-2024-49576\",\n     \"CVE-2024-47810\",\n     \"CVE-2024-28888\",\n     \"CVE-2024-7725\",\n     \"CVE-2024-9254\",\n    \"CVE-2024-7722\",\n    \"CVE-2024-7723\",\n    \"CVE-2024-7724\",\n     \"CVE-2024-9243\",\n    \"CVE-2024-9246\",\n    \"CVE-2024-9250\",\n    \"CVE-2024-9252\",\n    \"CVE-2024-9253\",\n    \"CVE-2024-9251\",\n    \"CVE-2024-9255\",\n    \"CVE-2024-9256\",\n    \"CVE-2024-9245\",\n    \"CVE-2024-9244\",\n    \"CVE-2024-38393\",\n    \"CVE-2024-48618\",\n    \"CVE-2024-9247\",\n    \"CVE-2024-9249\",\n    \"CVE-2024-9248\",\n    \"CVE-2024-41605\",\n    \"CVE-2024-7722\",\n      \"CVE-2024-25938\",\n    \"CVE-2024-25648\",\n      \"CVE-2024-25575\",\n    \"CVE-2024-30324\",\n    \"CVE-2024-30327\",\n    \"CVE-2024-30328\",\n    \"CVE-2024-30331\",\n    \"CVE-2024-30336\",\n    \"CVE-2024-30342\",\n    \"CVE-2024-30343\",\n    \"CVE-2024-30344\",\n    \"CVE-2024-30345\",\n    \"CVE-2024-30346\",\n    \"CVE-2024-30351\",\n    \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n    \"CVE-2024-30363\",\n        \"CVE-2024-30361\",\n    \"CVE-2024-30362\",\n     \"CVE-2024-30354\",\n    \"CVE-2024-30365\",\n    \"CVE-2024-30366\",\n    \"CVE-2024-25858\",\n      \"CVE-2024-30322\",\n      \"CVE-2024-30325\",\n      \"CVE-2024-30326\",\n      \"CVE-2024-30329\",\n      \"CVE-2024-30330\",\n      \"CVE-2024-30332\",\n      \"CVE-2024-30333\",\n      \"CVE-2024-30334\",\n      \"CVE-2024-30335\",\n    \"CVE-2024-30337\",\n      \"CVE-2024-30338\",\n        \"CVE-2024-30339\",\n    \"CVE-2024-30340\",\n      \"CVE-2024-30347\",\n    \"CVE-2024-30350\",\n        \"CVE-2024-30352\",\n    \"CVE-2024-30353\",\n      \"CVE-2024-30355\",\n          \"CVE-2024-30358\",\n        \"CVE-2024-30349\",\n      \"CVE-2024-30364\",\n     \"CVE-2024-30367\",\n    \"CVE-2024-30371\",\n       \"CVE-2024-30323\",\n    \"CVE-2024-30360\",\n    \"CVE-2024-32488\",\n    \"CVE-2024-30356\",\n   \"CVE-2023-51549\",\n      \"CVE-2023-51550\",\n    \"CVE-2023-51552\",\n    \"CVE-2023-51554\",\n       \"CVE-2023-51553\",\n    \"CVE-2023-32616\",\n     \"CVE-2023-41257\",\n    \"CVE-2023-38573\",\n     \"CVE-2023-51555\",\n    \"CVE-2023-51556\",\n    \"CVE-2023-51557\",\n    \"CVE-2023-51558\",\n      \"CVE-2023-51559\",\n    \"CVE-2023-51551\",\n    \"CVE-2023-51562\",\n    \"CVE-2023-40194\",\n    \"CVE-2023-35985\",\n    \"CVE-2023-51560\",\n      \"CVE-2023-42089\",\n        \"CVE-2023-42090\",\n          \"CVE-2023-42091\",\n      \"CVE-2023-42092\",\n      \"CVE-2023-42093\",\n        \"CVE-2023-42094\",\n        \"CVE-2023-42095\",\n          \"CVE-2023-42096\",\n        \"CVE-2023-42097\",\n        \"CVE-2023-42098\",\n     \"CVE-2023-39542\",\n         \"CVE-2023-51561\",\n            \"CVE-2023-27363\",\n     \"CVE-2023-27364\",\n    \"CVE-2023-27365\",\n    \"CVE-2023-27366\",\n        \"CVE-2024-29072\",\n    \"CVE-2024-30324\",\n        \"CVE-2024-30327\",\n    \"CVE-2024-30328\",\n    \"CVE-2024-30331\",\n    \"CVE-2024-30336\",\n    \"CVE-2024-30342\",\n    \"CVE-2024-30343\",\n    \"CVE-2024-30344\",\n    \"CVE-2024-30345\",\n    \"CVE-2024-30346\",\n    \"CVE-2024-30351\",\n    \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n    \"CVE-2024-30363\",\n        \"CVE-2024-30361\",\n    \"CVE-2024-30362\",\n     \"CVE-2024-30354\",\n    \"CVE-2024-30365\",\n    \"CVE-2024-30366\",\n     \"CVE-2024-30322\",\n      \"CVE-2024-30325\",\n      \"CVE-2024-30326\",\n      \"CVE-2024-30329\",\n      \"CVE-2024-30330\",\n      \"CVE-2024-30332\",\n      \"CVE-2024-30333\",\n      \"CVE-2024-30334\",\n      \"CVE-2024-30335\",\n        \"CVE-2024-30337\",\n        \"CVE-2024-30338\",\n        \"CVE-2024-30339\",\n            \"CVE-2024-30340\",\n        \"CVE-2024-30341\",\n            \"CVE-2024-30347\",\n    \"CVE-2024-30350\",\n        \"CVE-2024-30352\",\n    \"CVE-2024-30353\",\n      \"CVE-2024-30355\",\n      \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n      \"CVE-2024-30358\",\n        \"CVE-2024-30349\",\n    \"CVE-2024-30360\",\n          \"CVE-2024-30364\",\n        \"CVE-2024-30367\",\n    \"CVE-2024-30371\",\n  \"CVE-2023-38105\",\n   \"CVE-2023-38106\",\n  \"CVE-2023-38108\",\n    \"CVE-2023-38116\",\n    \"CVE-2023-38119\",\n    \"CVE-2023-38118\",\n        \"CVE-2023-28744\",\n    \"CVE-2023-38111\",\n    \"CVE-2023-38107\",\n    \"CVE-2023-38109\",\n     \"CVE-2023-38113\",\n    \"CVE-2023-38114\",\n      \"CVE-2023-38112\",\n      \"CVE-2023-38110\",\n        \"CVE-2023-38115\",\n      \"CVE-2023-38117\",\n    \"CVE-2023-27379\",\n    \"CVE-2023-33866\",\n   \"CVE-2023-32664\",\n   \"CVE-2023-33876\",\n   \"CVE-2024-25938\",\n   \"CVE-2024-25648\",\n   \"CVE-2024-25575\",\n       \"CVE-2024-25858\",\n   \"CVE-2024-30322\",\n    \"CVE-2024-30324\",\n     \"CVE-2024-30325\",\n        \"CVE-2024-30326\",\n        \"CVE-2024-30327\",\n    \"CVE-2024-30328\",\n    \"CVE-2024-30329\",\n        \"CVE-2024-30330\",\n     \"CVE-2024-30331\",\n     \"CVE-2024-30332\",\n     \"CVE-2024-30333\",\n     \"CVE-2024-30334\",\n      \"CVE-2024-30335\",\n    \"CVE-2024-30336\",\n    \"CVE-2024-30337\",\n     \"CVE-2024-30338\",\n      \"CVE-2024-30339\",\n     \"CVE-2024-30340\",\n    \"CVE-2024-30342\",\n        \"CVE-2024-30343\",\n    \"CVE-2024-30344\",\n    \"CVE-2024-30345\",\n        \"CVE-2024-30346\",\n     \"CVE-2024-30347\",\n    \"CVE-2024-30350\",\n      \"CVE-2024-30351\",\n     \"CVE-2024-30352\",\n    \"CVE-2024-30353\",\n     \"CVE-2024-30355\",\n     \"CVE-2024-30357\",\n    \"CVE-2024-30348\",\n    \"CVE-2024-30358\",\n     \"CVE-2024-30349\",\n    \"CVE-2024-30363\",\n     \"CVE-2024-30364\",\n    \"CVE-2024-30367\",\n      \"CVE-2024-30371\",\n            \"CVE-2024-30323\",\n        \"CVE-2024-30360\",\n         \"CVE-2024-30361\",\n     \"CVE-2024-30362\",\n    \"CVE-2024-30341\",\n     \"CVE-2024-30354\",\n       \"CVE-2024-30359\",\n    \"CVE-2024-30365\",\n    \"CVE-2024-30366\",\n   \"CVE-2024-25938\",\n   \"CVE-2024-25648\",\n    \"CVE-2024-25575\",\n  \"CVE-2024-29072\",\n  \"CVE-2024-28888\",\n      \"CVE-2024-7722\",\n    \"CVE-2024-7723\",\n    \"CVE-2024-7724\",\n     \"CVE-2024-7725\",\n   \"CVE-2024-9243\",\n    \"CVE-2024-9246\",\n    \"CVE-2024-9250\",\n        \"CVE-2024-9252\",\n    \"CVE-2024-9253\",\n    \"CVE-2024-9251\",\n        \"CVE-2024-9254\",\n    \"CVE-2024-9255\",\n    \"CVE-2024-9256\",\n     \"CVE-2024-9245\",\n    \"CVE-2024-9244\",\n     \"CVE-2024-38393\",\n    \"CVE-2024-48618\",\n   \"CVE-2024-9247\",\n      \"CVE-2024-9249\",\n    \"CVE-2024-9248\",\n     \"CVE-2024-41605\",\n      \"CVE-2024-12751\",\n     \"CVE-2024-12752\",\n    \"CVE-2024-49576\",\n        \"CVE-2024-47810\",\n      \"CVE-2024-12753\"\n\n\n  ],\n  \"root_cause\": \"The vulnerability is caused by a lack of proper validation of user-supplied data when handling U3D objects in PDF files, which results in a write past the end of an allocated data structure.\",\n  \"vulnerabilities\": [\n    \"Out-of-Bounds Write\"\n  ],\n  \"impact\": \"An attacker can leverage this vulnerability to execute code in the context of the current process.\",\n  \"attack_vectors\": [\n    \"The target must visit a malicious page or open a malicious file.\"\n  ],\n  \"attacker_capabilities\": \"The attacker needs to craft a malicious PDF file with a malformed U3D object.\",\n  \"additional_information\": \"Foxit has issued an update to correct this vulnerability. More details can be found at:\"\n}\n```\n\n## Retriever Results\n\n### Top Combined Results\n\n| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |\n|------|--------|------|-------------|-------|------------|-------------------|\n| 1 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.746 |\n| 2 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.705 |\n| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.643 |\n| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.639 |\n| 5 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.629 |\n| 6 | 356 | Product UI does not Warn User of Unsafe Actions | Base | Allowed | dense | 0.562 |\n| 7 | 125 | Out-of-bounds Read | Base | Allowed | graph | 0.002 |\n| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.614 |\n| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.611 |\n| 10 | 788 | Access of Memory Location After End of Buffer | Base | Discouraged | sparse | 0.597 |\n\n\n\n# Complete CWE Specifications\n\n\n## CWE-787: Out-of-bounds Write\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product writes data past the end, or before the beginning, of the intended buffer.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nMemory Corruption: Often used to describe the consequences of writing to memory outside the bounds of a buffer, or to memory that is otherwise invalid.\n\n### Relationships\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2023-1017:** The reference implementation code for a Trusted Platform Module does not implement length checks on data, allowing for an attacker to write 2 bytes past the end of a buffer.\n- **CVE-2021-21220:** Chain: insufficient input validation (CWE-20) in browser allows heap corruption (CWE-787), as exploited in the wild per CISA KEV.\n- **CVE-2021-28664:** GPU kernel driver allows memory corruption because a user can obtain read/write access to read-only pages, as exploited in the wild per CISA KEV.\n\n\n\n\n## CWE-20: Improper Input Validation\n**Abstraction:** Class\n**Status:** Stable\n\n### Description\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.\n\n### Extended Description\n\n\nInput validation is a frequently-used technique for checking potentially dangerous inputs in order to ensure that the inputs are safe for processing within the code, or when communicating with other components. When software does not validate input properly, an attacker is able to craft the input in a form that is not expected by the rest of the application. This will lead to parts of the system receiving unintended input, which may result in altered control flow, arbitrary control of a resource, or arbitrary code execution.\n\n\nInput validation is not the only technique for processing input, however. Other techniques attempt to transform potentially-dangerous input into something safe, such as filtering (CWE-790) - which attempts to remove dangerous inputs - or encoding/escaping (CWE-116), which attempts to ensure that the input is not misinterpreted when it is included in output to another component. Other techniques exist as well (see CWE-138 for more examples.)\n\n\nInput validation can be applied to:\n\n\n  - raw data - strings, numbers, parameters, file contents, etc.\n\n  - metadata - information about the raw data, such as headers or size\n\nData can be simple or structured. Structured data can be composed of many nested layers, composed of combinations of metadata and raw data, with other simple or structured data.\n\nMany properties of raw data or metadata may need to be validated upon entry into the code, such as:\n\n\n  - specified quantities such as size, length, frequency, price, rate, number of operations, time, etc.\n\n  - implied or derived quantities, such as the actual size of a file instead of a specified size\n\n  - indexes, offsets, or positions into more complex data structures\n\n  - symbolic keys or other elements into hash tables, associative arrays, etc.\n\n  - well-formedness, i.e. syntactic correctness - compliance with expected syntax \n\n  - lexical token correctness - compliance with rules for what is treated as a token\n\n  - specified or derived type - the actual type of the input (or what the input appears to be)\n\n  - consistency - between individual data elements, between raw data and metadata, between references, etc.\n\n  - conformance to domain-specific rules, e.g. business logic \n\n  - equivalence - ensuring that equivalent inputs are treated the same\n\n  - authenticity, ownership, or other attestations about the input, e.g. a cryptographic signature to prove the source of the data\n\nImplied or derived properties of data must often be calculated or inferred by the code itself. Errors in deriving properties may be considered a contributing factor to improper input validation. \n\nNote that \"input validation\" has very different meanings to different people, or within different classification schemes. Caution must be used when referencing this CWE entry or mapping to it. For example, some weaknesses might involve inadvertently giving control to an attacker over an input when they should not be able to provide an input at all, but sometimes this is referred to as input validation.\n\n\nFinally, it is important to emphasize that the distinctions between input validation and output escaping are often blurred, and developers must be careful to understand the difference, including how input validation is not always sufficient to prevent vulnerabilities, especially when less stringent data types must be supported, such as free-form text. Consider a SQL injection scenario in which a person's last name is inserted into a query. The name \"O'Reilly\" would likely pass the validation step since it is a common last name in the English language. However, this valid name cannot be directly inserted into the database because it contains the \"'\" apostrophe character, which would need to be escaped or otherwise transformed. In this case, removing the apostrophe might reduce the risk of SQL injection, but it would produce incorrect behavior because the wrong name would be recorded.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-707\nPeerOf -> CWE-345\nCanPrecede -> CWE-22\nCanPrecede -> CWE-41\nCanPrecede -> CWE-74\nCanPrecede -> CWE-119\nCanPrecede -> CWE-770\n\n### Mapping Guidance\n**Usage:** Discouraged\n**Rationale:** CWE-20 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available [REF-1287]. It is not useful for trend analysis. It is also a level-1 Class (i.e., a child of a Pillar).\n**Comments:** Consider lower-level children such as Improper Use of Validation Framework (CWE-1173) or improper validation involving specific types or properties of input such as Specified Quantity (CWE-1284); Specified Index, Position, or Offset (CWE-1285); Syntactic Correctness (CWE-1286); Specified Type (CWE-1287); Consistency within Input (CWE-1288); or Unsafe Equivalence (CWE-1289).\n**Reasons:**\n- Frequent Misuse\n**Suggested Alternatives:**\n- CWE-1284: Specified Quantity\n- CWE-1285: Specified Index, Position, or Offset\n- CWE-1286: Syntactic Correctness\n- CWE-1287: Specified Type\n- CWE-1288: Consistency within Input\n- CWE-1289: Unsafe Equivalence\n- CWE-116: Improper Encoding or Escaping of Output\n\n\n### Additional Notes\n**[Relationship]** \n\nCWE-116 and CWE-20 have a close association because, depending on the nature of the structured message, proper input validation can indirectly prevent special characters from changing the meaning of a structured message. For example, by validating that a numeric ID field should only contain the 0-9 characters, the programmer effectively prevents injection attacks.\n\n\n**[Maintenance]** As of 2020, this entry is used more often than preferred, and it is a source of frequent confusion. It is being actively modified for CWE 4.1 and subsequent versions.\n\n**[Maintenance]** Concepts such as validation, data transformation, and neutralization are being refined, so relationships between CWE-20 and other entries such as CWE-707 may change in future versions, along with an update to the Vulnerability Theory document.\n\n**[Maintenance]** Input validation - whether missing or incorrect - is such an essential and widespread part of secure development that it is implicit in many different weaknesses. Traditionally, problems such as buffer overflows and XSS have been classified as input validation problems by many security professionals. However, input validation is not necessarily the only protection mechanism available for avoiding such problems, and in some cases it is not even sufficient. The CWE team has begun capturing these subtleties in chains within the Research Concepts view (CWE-1000), but more work is needed.\n\n**[Terminology]** \n\nThe \"input validation\" term is extremely common, but it is used in many different ways. In some cases its usage can obscure the real underlying weakness or otherwise hide chaining and composite relationships.\n\n\nSome people use \"input validation\" as a general term that covers many different neutralization techniques for ensuring that input is appropriate, such as filtering, canonicalization, and escaping. Others use the term in a more narrow context to simply mean \"checking if an input conforms to expectations without changing it.\" CWE uses this more narrow interpretation.\n\n\n\n\n### Observed Examples\n- **CVE-2024-37032:** Large language model (LLM) management tool does not validate the format of a digest value (CWE-1287) from a private, untrusted model registry, enabling relative path traversal (CWE-23), a.k.a. Probllama\n- **CVE-2022-45918:** Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using \"../\" sequences (CWE-24)\n- **CVE-2021-30860:** Chain: improper input validation (CWE-20) leads to integer overflow (CWE-190) in mobile OS, as exploited in the wild per CISA KEV.\n\n\n\n\n## CWE-1284: Improper Validation of Specified Quantity in Input\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.\n\n### Extended Description\n\n\nSpecified quantities include size, length, frequency, price, rate, number of operations, time, and others. Code may rely on specified quantities to allocate resources, perform calculations, control iteration, etc. When the quantity is not properly validated, then attackers can specify malicious quantities to cause excessive resource allocation, trigger unexpected failures, enable buffer overflows, etc.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-20\nChildOf -> CWE-20\nCanPrecede -> CWE-789\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** This entry is still under development and will continue to see updates and content improvements.\n\n\n\n### Observed Examples\n- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).\n- **CVE-2008-1440:** lack of validation of length field leads to infinite loop\n- **CVE-2008-2374:** lack of validation of string length fields allows memory consumption or buffer over-read\n\n\n\n\n## CWE-122: Heap-based Buffer Overflow\n**Abstraction:** Variant\n**Status:** Draft\n\n### Description\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-788\nChildOf -> CWE-787\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** Heap-based buffer overflows are usually just as dangerous as stack-based buffer overflows.\n\n\n\n### Observed Examples\n- **CVE-2021-43537:** Chain: in a web browser, an unsigned 64-bit integer is forcibly cast to a 32-bit integer (CWE-681) and potentially leading to an integer overflow (CWE-190). If an integer overflow occurs, this can cause heap memory corruption (CWE-122)\n- **CVE-2007-4268:** Chain: integer signedness error (CWE-195) passes signed comparison, leading to heap overflow (CWE-122)\n- **CVE-2009-2523:** Chain: product does not handle when an input string is not NULL terminated (CWE-170), leading to buffer over-read (CWE-125) or heap-based buffer overflow (CWE-122).\n\n\n\n\n## CWE-121: Stack-based Buffer Overflow\n**Abstraction:** Variant\n**Status:** Draft\n\n### Description\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nStack Overflow: \"Stack Overflow\" is often used to mean the same thing as stack-based buffer overflow, however it is also used on occasion to mean stack exhaustion, usually a result from an excessively recursive function call. Due to the ambiguity of the term, use of stack overflow to describe either circumstance is discouraged.\n\n### Relationships\nChildOf -> CWE-788\nChildOf -> CWE-787\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Other]** Stack-based buffer overflows can instantiate in return address overwrites, stack pointer overwrites or frame pointer overwrites. They can also be considered function pointer overwrites, array indexer overwrites or write-what-where condition, etc.\n\n\n\n### Observed Examples\n- **CVE-2021-35395:** Stack-based buffer overflows in SFK for wifi chipset used for IoT/embedded devices, as exploited in the wild per CISA KEV.\n\n\n\n\n## CWE-356: Product UI does not Warn User of Unsafe Actions\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product's user interface does not warn the user before undertaking an unsafe action on behalf of that user. This makes it easier for attackers to trick users into inflicting damage to their system.\n\n### Extended Description\nProduct systems should warn users that a potentially dangerous action may occur if the user proceeds. For example, if the user downloads a file from an unknown source and attempts to execute the file on their machine, then the application's GUI can indicate that the file is unsafe.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-221\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** Often resultant, e.g. in unhandled error conditions.\n\n**[Relationship]** Can overlap privilege errors, conceptually at least.\n\n\n\n### Observed Examples\n- **CVE-1999-1055:** Product does not warn user when document contains certain dangerous functions or macros.\n- **CVE-1999-0794:** Product does not warn user when document contains certain dangerous functions or macros.\n- **CVE-2000-0277:** Product does not warn user when document contains certain dangerous functions or macros.\n\n\n\n\n## CWE-125: Out-of-bounds Read\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product reads data past the end, or before the beginning, of the intended buffer.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nOOB read: Shorthand for \"Out of bounds\" read\n\n### Relationships\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2023-1018:** The reference implementation code for a Trusted Platform Module does not implement length checks on data, allowing for an attacker to read 2 bytes past the end of a buffer.\n- **CVE-2020-11899:** Out-of-bounds read in IP stack used in embedded systems, as exploited in the wild per CISA KEV.\n- **CVE-2014-0160:** Chain: \"Heartbleed\" bug receives an inconsistent length parameter (CWE-130) enabling an out-of-bounds read (CWE-126), returning memory that could include private cryptographic keys and other sensitive data.\n\n\n\n\n## CWE-732: Incorrect Permission Assignment for Critical Resource\n**Abstraction:** Class\n**Status:** Draft\n\n### Description\nThe product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\n\n### Extended Description\nWhen a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution, or sensitive user data. For example, consider a misconfigured storage account for the cloud that can be read or written by a public or anonymous user.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-285\nChildOf -> CWE-668\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** While the name itself indicates an assignment of permissions for resources, this is often misused for vulnerabilities in which \"permissions\" are not checked, which is an \"authorization\" weakness (CWE-285 or descendants) within CWE's model [REF-1287].\n**Comments:** Closely analyze the specific mistake that is allowing the resource to be exposed, and perform a CWE mapping for that mistake.\n**Reasons:**\n- Frequent Misuse\n\n\n### Additional Notes\n**[Maintenance]** The relationships between privileges, permissions, and actors (e.g. users and groups) need further refinement within the Research view. One complication is that these concepts apply to two different pillars, related to control of resources (CWE-664) and protection mechanism failures (CWE-693).\n\n\n\n### Observed Examples\n- **CVE-2022-29527:** Go application for cloud management creates a world-writable sudoers file that allows local attackers to inject sudo rules and escalate privileges to root by winning a race condition.\n- **CVE-2009-3482:** Anti-virus product sets insecure \"Everyone: Full Control\" permissions for files under the \"Program Files\" folder, allowing attackers to replace executables with Trojan horses.\n- **CVE-2009-3897:** Product creates directories with 0777 permissions at installation, allowing users to gain privileges and access a socket used for authentication.\n\n\n\n\n## CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer\n**Abstraction:** Class\n**Status:** Stable\n\n### Description\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nBuffer Overflow: This term has many different meanings to different audiences. From a CWE mapping perspective, this term should be avoided where possible. Some researchers, developers, and tools intend for it to mean \"write past the end of a buffer,\" whereas others use the same term to mean \"any read or write outside the boundaries of a buffer, whether before the beginning of the buffer or after the end of the buffer.\" Others could mean \"any action after the end of a buffer, whether it is a read or write.\" Since the term is commonly used for exploitation and for vulnerabilities, it further confuses things.\nbuffer overrun: Some prominent vendors and researchers use the term \"buffer overrun,\" but most people use \"buffer overflow.\" See the alternate term for \"buffer overflow\" for context.\nmemory safety: Generally used for techniques that avoid weaknesses related to memory access, such as those identified by CWE-119 and its descendants. However, the term is not formal, and there is likely disagreement between practitioners as to which weaknesses are implicitly covered by the \"memory safety\" term.\n\n### Relationships\nChildOf -> CWE-118\nChildOf -> CWE-20\n\n### Mapping Guidance\n**Usage:** Discouraged\n**Rationale:** CWE-119 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available.\n**Comments:** Look at CWE-119's children and consider mapping to CWEs such as CWE-787: Out-of-bounds Write, CWE-125: Out-of-bounds Read, or others.\n**Reasons:**\n- Frequent Misuse\n\n\n### Additional Notes\n**[Applicable Platform]** \n\nIt is possible in any programming languages without memory management support to attempt an operation outside of the bounds of a memory buffer, but the consequences will vary widely depending on the language, platform, and chip architecture.\n\n\n\n\n### Observed Examples\n- **CVE-2021-22991:** Incorrect URI normalization in application traffic product leads to buffer overflow, as exploited in the wild per CISA KEV.\n- **CVE-2020-29557:** Buffer overflow in Wi-Fi router web interface, as exploited in the wild per CISA KEV.\n- **CVE-2009-2550:** Classic stack-based buffer overflow in media player using a long entry in a playlist\n\n\n\n\n## CWE-788: Access of Memory Location After End of Buffer\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product reads or writes to a buffer using an index or pointer that references a memory location after the end of the buffer.\n\n### Extended Description\nThis typically occurs when a pointer or its index is incremented to a position after the buffer; or when pointer arithmetic results in a position after the buffer.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-119\nChildOf -> CWE-119\nChildOf -> CWE-119\n\n### Mapping Guidance\n**Usage:** Discouraged\n**Rationale:** The CWE entry might be misused when lower-level CWE entries might be available. It also overlaps existing CWE entries and might be deprecated in the future.\n**Comments:** If the \"Access\" operation is known to be a read or a write, then investigate children of entries such as CWE-787: Out-of-bounds Write and CWE-125: Out-of-bounds Read.\n**Reasons:**\n- Potential Deprecation\n- Frequent Misuse\n\n\n\n### Observed Examples\n- **CVE-2009-2550:** Classic stack-based buffer overflow in media player using a long entry in a playlist\n- **CVE-2009-2403:** Heap-based buffer overflow in media player using a long entry in a playlist\n- **CVE-2009-0689:** large precision value in a format string triggers overflow\n\n"
  },
  "timestamp": "2025-04-02 16:21:01",
  "cve_id": "unknown",
  "result_count": 10,
  "results": [
    {
      "cwe_id": "131",
      "name": "Incorrect Calculation of Buffer Size",
      "type": "Base",
      "score": 0.7442933775108207
    },
    {
      "cwe_id": "805",
      "name": "Buffer Access with Incorrect Length Value",
      "type": "Base",
      "score": 0.7426626396254582
    },
    {
      "cwe_id": "404",
      "name": "Improper Resource Shutdown or Release",
      "type": "Class",
      "score": 0.7394221040357865
    },
    {
      "cwe_id": "1289",
      "name": "Improper Validation of Unsafe Equivalence in Input",
      "type": "Base",
      "score": 0.7376307268105378
    },
    {
      "cwe_id": "653",
      "name": "Improper Isolation or Compartmentalization",
      "type": "Class",
      "score": 0.7358109966309705
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "type": "Base",
      "score": 0.7339119696172034
    },
    {
      "cwe_id": "788",
      "name": "Access of Memory Location After End of Buffer",
      "type": "Base",
      "score": 0.7326882741390635
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "type": "Base",
      "score": 0.7312845184191151
    },
    {
      "cwe_id": "124",
      "name": "Buffer Underwrite ('Buffer Underflow')",
      "type": "Base",
      "score": 0.7311098152371743
    },
    {
      "cwe_id": "226",
      "name": "Sensitive Information in Resource Not Removed Before Reuse",
      "type": "Base",
      "score": 0.7310618768018912
    }
  ]
}