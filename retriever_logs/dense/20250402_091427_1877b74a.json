{
  "retriever": "dense",
  "query": "## Vulnerability Description\nSymfony is a PHP framework for web and console applications and a set of reusable PHP components. The ability to enumerate users was possible without relevant permissions due to **different handling depending on whether the user existed or not when attempting to use the switch users functionality**. We now ensure that 403s are returned whether the user exists or not if a user cannot switch to a user or if the user does not exist. The patch for this issue is available for branch 3.4.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **different handling depending on whether the user existed or not when attempting to use the switch users functionality**\n- **impact:** enumerate users without relevant permissions\n- **product:** Symfony\n- **version:** 3.4\n\n## CVE Reference Links Content Summary\n```\n{\n  \"guidelines\": \"1. First verify if the content relates to the CVE specified based on the official description\\n2. If the content does not relate to this CVE, respond with \\\"UNRELATED\\\"\\n3. If no useful vulnerability information is found, respond with \\\"NOINFO\\\" \\n4. For relevant content, extract:\\n   - Root cause of vulnerability\\n   - Weaknesses/vulnerabilities present\\n   - Impact of exploitation\\n   - Attack vectors\\n   - Required attacker capabilities/position\\n\\nAdditional instructions:\\n- Preserve original technical details and descriptions\\n- Remove unrelated content\\n- Translate non-English content to English\\n- Note if the content provides more detail than the official CVE description\",\n  \"response\": {\n    \"CVE-2021-21424\": [\n      {\n        \"content\": \"title: \\\"CVE-2021-21424: Prevent user enumeration via response content in authentication mechanisms\\\"\\nlink: https://symfony.com/cve-2021-21424\\ncve: CVE-2021-21424\\nbranches:\\n 2.8.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.8.0', '<3.0.0']\\n 3.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.0.0', '<3.1.0']\\n 3.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.1.0', '<3.2.0']\\n 3.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.2.0', '<3.3.0']\\n 3.3.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.3.0', '<3.4.0']\\n 3.4.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.4.0', '<3.4.49']\\n 4.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.0.0', '<4.1.0']\\n 4.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.1.0', '<4.2.0']\\n 4.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.2.0', '<4.3.0']\\n 4.3.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.3.0', '<4.4.0']\\n 4.4.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.4.0', '<4.4.24']\\n 5.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.0.0', '<5.1.0']\\n 5.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.1.0', '<5.2.0']\\n 5.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.2.0', '<5.2.9']\\nreference: composer://symfony/symfony\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration. A timing attack was also possible.\",\n        \"weaknesses\": [\n          \"User enumeration\",\n          \"Timing attack vulnerability\"\n        ],\n        \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n      {\n        \"content\": \"title: \\\"CVE-2021-21424: Prevent user enumeration via response content in authentication mechanisms\\\"\\nlink: https://symfony.com/cve-2021-21424\\ncve: CVE-2021-21424\\nbranches:\\n 5.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.1.0', '<5.2.0']\\n 5.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.2.0', '<5.2.8']\\nreference: composer://symfony/security-http\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration. A timing attack was also possible.\",\n         \"weaknesses\": [\n          \"User enumeration\",\n          \"Timing attack vulnerability\"\n        ],\n        \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n       {\n        \"content\": \"title: \\\"CVE-2021-21424: Prevent user enumeration via response content in authentication mechanisms\\\"\\nlink: https://symfony.com/cve-2021-21424\\ncve: CVE-2021-21424\\nbranches:\\n 2.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.0.0', '<2.1.0']\\n 2.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.1.0', '<2.2.0']\\n 2.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.2.0', '<2.3.0']\\n 2.3.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.3.0', '<2.4.0']\\n 2.4.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.4.0', '<2.5.0']\\n 2.5.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.5.0', '<2.6.0']\\n 2.6.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.6.0', '<2.7.0']\\n 2.7.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.7.0', '<2.8.0']\\n 2.8.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.8.0', '<2.9.0']\\n 2.9.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.9.0', '<2.10.0']\\n 2.10.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.10.0', '<2.10.7']\\n 2.11.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.11.0', '<2.11.3']\\nreference: composer://lexik/jwt-authentication-bundle\",\n         \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration. A timing attack was also possible.\",\n         \"weaknesses\": [\n          \"User enumeration\",\n          \"Timing attack vulnerability\"\n        ],\n        \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n      {\n        \"content\": \"title: \\\"CVE-2021-21424: Prevent user enumeration via response content in authentication mechanisms\\\"\\nlink: https://symfony.com/cve-2021-21424\\ncve: CVE-2021-21424\\nbranches:\\n 1.27.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=1.27.0', '<1.28.0']\\n 1.28.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=1.28.0', '<1.29.0']\\n 1.29.x:\\n   time: 2021-05-18 16:31:23\\n   versions: ['>=1.29.0', '<1.29.2']\\n 1.30.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=1.30.0', '<1.31.0']\\n 1.31.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=1.31.0', '<1.31.1']\\nreference: composer://symfony/maker-bundle\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration. A timing attack was also possible.\",\n         \"weaknesses\": [\n          \"User enumeration\",\n          \"Timing attack vulnerability\"\n        ],\n        \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n       {\n        \"content\": \"title: \\\"CVE-2021-21424: Prevent user enumeration via response content in authentication mechanisms\\\"\\nlink: https://symfony.com/cve-2021-21424\\ncve: CVE-2021-21424\\nbranches:\\n 2.8.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.8.0', '<3.0.0']\\n 3.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.0.0', '<3.1.0']\\n 3.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.1.0', '<3.2.0']\\n 3.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.2.0', '<3.3.0']\\n 3.3.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.3.0', '<3.4.0']\\n 3.4.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.4.0', '<3.4.48']\\n 4.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.0.0', '<4.1.0']\\n 4.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.1.0', '<4.2.0']\\n 4.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.2.0', '<4.3.0']\\n 4.3.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.3.0', '<4.4.0']\\n 4.4.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.4.0', '<4.4.23']\\n 5.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.0.0', '<5.1.0']\\n 5.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.1.0', '<5.2.0']\\n 5.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=5.2.0', '<5.2.8']\\nreference: composer://symfony/security-guard\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration. A timing attack was also possible.\",\n         \"weaknesses\": [\n          \"User enumeration\",\n          \"Timing attack vulnerability\"\n        ],\n        \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n        {\n        \"content\": \"title: \\\"CVE-2021-21424: Prevent user enumeration via response content in authentication mechanisms\\\"\\nlink: https://symfony.com/cve-2021-21424\\ncve: CVE-2021-21424\\nbranches:\\n 2.8.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=2.8.0', '<3.0.0']\\n 3.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.0.0', '<3.1.0']\\n 3.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.1.0', '<3.2.0']\\n 3.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.2.0', '<3.3.0']\\n 3.3.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.3.0', '<3.4.0']\\n 3.4.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=3.4.0', '<3.4.49']\\n 4.0.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.0.0', '<4.1.0']\\n 4.1.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.1.0', '<4.2.0']\\n 4.2.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.2.0', '<4.3.0']\\n 4.3.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.3.0', '<4.4.0']\\n 4.4.x:\\n  time: 2021-05-12 08:00:00\\n  versions: ['>=4.4.0', '<4.4.24']\\nreference: composer://symfony/security\",\n         \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration. A timing attack was also possible.\",\n         \"weaknesses\": [\n          \"User enumeration\",\n          \"Timing attack vulnerability\"\n        ],\n         \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n      {\n         \"content\": \"```\\n-------------------------------------------------------------------------\\nDebian LTS Advisory DLA-3493-1                debian-lts@lists.debian.org\\n<https://www.debian.org/lts/security/>                       Guilhem Moulin\\nJuly 11, 2023                                 <https://wiki.debian.org/LTS>\\n-------------------------------------------------------------------------\\n\\nPackage        : symfony\\nVersion        : 3.4.22+dfsg-2+deb10u2\\nCVE ID         : CVE-2021-21424 CVE-2022-24894 CVE-2022-24895\\n\\nMultiple security vulnerabilities were found in symfony, a PHP framework\\nfor web and console applications and a set of reusable PHP components,\\nwhich could lead to information disclosure or impersonation.\\n\\nCVE-2021-21424\\n\\n    James Isaac, Mathias Brodala and Laurent Minguet discovered that it\\n    was possible to enumerate users without relevant permissions due to\\n    different exception messages depending on whether the user existed\\n    or not.  It was also possible to enumerate users by using a timing\\n    attack, by comparing time elapsed when authenticating an existing\\n    user and authenticating a non-existing user.\\n\\n    403s are now returned whether the user exists or not if a user\\n    cannot switch to a user or if the user does not exist.\\n\\nCVE-2022-24894\\n\\n    Soner Sayakci discovered that when the Symfony HTTP cache system is\\n    enabled, the response header might be stored with a `Set-Cookie`\\n    header and returned to some other clients, thereby allowing an\\n    attacker to retrieve the victim's session.\\n\\n    The `HttpStore` constructor now takes a parameter containing a list\\n    of private headers that are removed from the HTTP response headers.\\n    The default value for this parameter is `Set-Cookie`, but it can be\\n    overridden or extended by the application.\\n\\nCVE-2022-24895\\n\\n    Marco Squarcina discovered that CSRF tokens aren't cleared upon\\n    login, which could enable same-site attackers to bypass the CSRF\\n    protection mechanism by performing an attack similar to a\\n    session-fixation.\\n\\nFor Debian 10 buster, these problems have been fixed in version\\n3.4.22+dfsg-2+deb10u2.\\n\\nWe recommend that you upgrade your symfony packages.\\n\\nFor the detailed security status of symfony please refer to\\nits security tracker page at:\\n<https://security-tracker.debian.org/tracker/symfony>\\n\\nFurther information about Debian LTS security advisories, how to apply\\nthese updates to your system and frequently asked questions can be\\nfound at: <https://wiki.debian.org/LTS>\\n\\n```\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration. A timing attack was also possible by measuring the time elapsed between authenticating an existing vs non existing user.\",\n         \"weaknesses\": [\n          \"User enumeration\",\n          \"Timing attack vulnerability\",\n          \"Information disclosure\"\n        ],\n         \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n           \"Authentication mechanisms\",\n           \"Response body content\",\n           \"Timing attacks\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n        {\n        \"content\": \"--------------------------------------------------------------------------------\\nFedora Update Notification\\nFEDORA-2021-2d145b95f6\\n2021-05-29 01:04:01.502352\\n--------------------------------------------------------------------------------\\n\\nName : php-symfony4\\nProduct : Fedora 34\\nVersion : 4.4.24\\nRelease : 1.fc34\\nURL : <https://symfony.com>\\nSummary : Symfony PHP framework (version 4)\\nDescription :\\nSymfony PHP framework (version 4).\\n\\nNOTE: Does not require PHPUnit bridge.\\n\\n--------------------------------------------------------------------------------\\nUpdate Information:\\n\\n\\\\*\\\\*Version 4.4.24\\\\*\\\\* (2021-05-19) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\* [Security\\\\Core]\\nFix user enumeration via response body on invalid credentials (chalasr) \\\\* bug\\n#41230 [FrameworkBundle][Validator] Fix deprecations from Doctrine\\nAnnotations+Cache (derrabus) \\\\* bug #41240 Fixed deprecation warnings about\\npassing null as parameter (derrabus) \\\\* bug #41241 [Finder] Fix gitignore regex\\nbuild with \\\"\\\\*\\\\*\\\" (mvorisek) \\\\* bug #41224 [HttpClient] fix adding query string to\\nrelative URLs with scoped clients (nicolas-grekas) \\\\* bug #41233\\n[DependencyInjection][ProxyManagerBridge] Don't call class_exists() on null\\n(derrabus) \\\\* bug #41210 [Console] Fix Windows code page support (orkan) ----\\n\\\\*\\\\*Version 4.4.23\\\\*\\\\* (2021-05-12) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\*\\n[Security][Guard] Prevent user enumeration (chalasr) \\\\* bug #41176\\n[DependencyInjection] fix dumping service-closure-arguments (nicolas-grekas) \\\\*\\nbug #41168 WDT: Only load \\\"Sfjs\\\" if it is not present already (weaverryan) \\\\*\\nbug #41147 [Inflector][String] wrong plural form of words ending by \\\"pectus\\\"\\n(makraz) \\\\* bug #41160 [HttpClient] Don't prepare the request in\\nScopingHttpClient (nicolas-grekas) \\\\* bug #40763 Fix/Rewrite .gitignore regex\\nbuilder (mvorisek) \\\\* bug #40917 [Config][DependencyInjection] Uniformize\\ntrailing slash handling (dunglas) \\\\* bug #40699 [PropertyInfo] Make\\nReflectionExtractor correctly extract nullability (shiftby) \\\\* bug #40874\\n[PropertyInfo] fix attribute namespace with recursive traits (soullivaneuh) \\\\*\\nbug #41099 [Cache] Check if phpredis version is compatible with stream parameter\\n(nicolassing) \\\\* bug #41072 [VarExporter] Add support of PHP enumerations\\n(alexandre-daubois) \\\\* bug #41105 [Inflector][String] Fixed singularize `edges`\\n\\n...\\n> `edge` (ruudk) \\\\* bug #41075 [ErrorHandler] Skip \\\"same vendor\\\" ``@method``\\n\\ndeprecations for `Symfony\\\\*` classes unless symfony/symfony is being tested\\n(nicolas-grekas)\\n--------------------------------------------------------------------------------\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration.\",\n         \"weaknesses\": [\n          \"User enumeration\"\n        ],\n        \"impact\": \"An attacker can enumerate existing users on the system.\",\n         \"attack_vectors\": [\n          \"Authentication mechanisms\",\n           \"Response body content\"\n        ],\n         \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n      {\n        \"content\": \"--------------------------------------------------------------------------------\\nFedora Update Notification\\nFEDORA-2021-121edb82dd\\n2021-05-28 01:10:41.955482\\n--------------------------------------------------------------------------------\\n\\nName : php-symfony4\\nProduct : Fedora 33\\nVersion : 4.4.24\\nRelease : 1.fc33\\nURL : <https://symfony.com>\\nSummary : Symfony PHP framework (version 4)\\nDescription :\\nSymfony PHP framework (version 4).\\n\\nNOTE: Does not require PHPUnit bridge.\\n\\n--------------------------------------------------------------------------------\\nUpdate Information:\\n\\n\\\\*\\\\*Version 4.4.24\\\\*\\\\* (2021-05-19) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\* [Security\\\\Core]\\nFix user enumeration via response body on invalid credentials (chalasr) \\\\* bug\\n#41230 [FrameworkBundle][Validator] Fix deprecations from Doctrine\\nAnnotations+Cache (derrabus) \\\\* bug #41240 Fixed deprecation warnings about\\npassing null as parameter (derrabus) \\\\* bug #41241 [Finder] Fix gitignore regex\\nbuild with \\\"\\\\*\\\\*\\\" (mvorisek) \\\\* bug #41224 [HttpClient] fix adding query string to\\nrelative URLs with scoped clients (nicolas-grekas) \\\\* bug #41233\\n[DependencyInjection][ProxyManagerBridge] Don't call class_exists() on null\\n(derrabus) \\\\* bug #41210 [Console] Fix Windows code page support (orkan) ----\\n\\\\*\\\\*Version 4.4.23\\\\*\\\\* (2021-05-12) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\*\\n[Security][Guard] Prevent user enumeration (chalasr) \\\\* bug #41176\\n[DependencyInjection] fix dumping service-closure-arguments (nicolas-grekas) \\\\*\\nbug #41168 WDT: Only load \\\"Sfjs\\\" if it is not present already (weaverryan) \\\\*\\nbug #41147 [Inflector][String] wrong plural form of words ending by \\\"pectus\\\"\\n(makraz) \\\\* bug #41160 [HttpClient] Don't prepare the request in\\nScopingHttpClient (nicolas-grekas) \\\\* bug #40763 Fix/Rewrite .gitignore regex\\nbuilder (mvorisek) \\\\* bug #40917 [Config][DependencyInjection] Uniformize\\ntrailing slash handling (dunglas) \\\\* bug #40699 [PropertyInfo] Make\\nReflectionExtractor correctly extract nullability (shiftby) \\\\* bug #40874\\n[PropertyInfo] fix attribute namespace with recursive traits (soullivaneuh) \\\\*\\nbug #41099 [Cache] Check if phpredis version is compatible with stream parameter\\n(nicolassing) \\\\* bug #41072 [VarExporter] Add support of PHP enumerations\\n(alexandre-daubois) \\\\* bug #41105 [Inflector][String] Fixed singularize `edges`\\n\\n...\\n> `edge` (ruudk) \\\\* bug #41075 [ErrorHandler] Skip \\\"same vendor\\\" ``@method``\\n\\ndeprecations for `Symfony\\\\*` classes unless symfony/symfony is being tested\\n(nicolas-grekas)\\n--------------------------------------------------------------------------------\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration.\",\n        \"weaknesses\": [\n          \"User enumeration\"\n        ],\n       \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n           \"Response body content\"\n        ],\n         \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n      {\n        \"content\": \"--------------------------------------------------------------------------------\\nFedora Update Notification\\nFEDORA-2021-f3ad34aa9f\\n2021-05-28 01:10:41.955472\\n--------------------------------------------------------------------------------\\n\\nName : php-symfony3\\nProduct : Fedora 33\\nVersion : 3.4.49\\nRelease : 1.fc33\\nURL : <https://symfony.com>\\nSummary : Symfony PHP framework (version 3)\\nDescription :\\nSymfony PHP framework (version 3).\\n\\nNOTE: Does not require PHPUnit bridge.\\n\\n--------------------------------------------------------------------------------\\nUpdate Information:\\n\\n\\\\*\\\\*Version 3.4.49\\\\*\\\\* (2021-05-19) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\* [Security\\\\Core]\\nFix user enumeration via response body on invalid credentials (chalasr) ----\\n\\\\*\\\\*Version 3.4.48\\\\*\\\\* (2021-05-12) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\*\\n[Security][Guard] Prevent user enumeration (chalasr)\\n--------------------------------------------------------------------------------\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration.\",\n        \"weaknesses\": [\n          \"User enumeration\"\n        ],\n        \"impact\": \"An attacker can enumerate existing users on the system.\",\n        \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\": \"An attacker can send authentication requests to the system.\"\n      },\n       {\n        \"content\": \"--------------------------------------------------------------------------------\\nFedora Update Notification\\nFEDORA-2021-c57937ab9f\\n2021-05-29 01:04:01.502342\\n--------------------------------------------------------------------------------\\n\\nName : php-symfony3\\nProduct : Fedora 34\\nVersion : 3.4.49\\nRelease : 1.fc34\\nURL : <https://symfony.com>\\nSummary : Symfony PHP framework (version 3)\\nDescription :\\nSymfony PHP framework (version 3).\\n\\nNOTE: Does not require PHPUnit bridge.\\n\\n--------------------------------------------------------------------------------\\nUpdate Information:\\n\\n\\\\*\\\\*Version 3.4.49\\\\*\\\\* (2021-05-19) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\* [Security\\\\Core]\\nFix user enumeration via response body on invalid credentials (chalasr) ----\\n\\\\*\\\\*Version 3.4.48\\\\*\\\\* (2021-05-12) \\\\* security \\\\*\\\\*CVE-2021-21424\\\\*\\\\*\\n[Security][Guard] Prevent user enumeration (chalasr)\\n--------------------------------------------------------------------------------\",\n        \"root_cause\": \"The vulnerability was caused by different exception messages depending on whether the user existed or not, which allowed for user enumeration.\",\n         \"weaknesses\": [\n          \"User enumeration\"\n        ],\n         \"impact\": \"An attacker can enumerate existing users on the system.\",\n         \"attack_vectors\": [\n          \"Authentication mechanisms\",\n          \"Response body content\"\n        ],\n        \"required_capabilities\":\n\n## Retriever Results\n\n### Top Combined Results\n\n| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |\n|------|--------|------|-------------|-------|------------|-------------------|\n| 1 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.698 |\n| 2 | 204 | Observable Response Discrepancy | Base | Allowed | sparse | 0.540 |\n| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.538 |\n| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.535 |\n| 5 | 613 | Insufficient Session Expiration | Base | Allowed | sparse | 0.534 |\n| 6 | 286 | Incorrect User Management | Class | Allowed-with-Review | dense | 0.397 |\n| 7 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | graph | 0.002 |\n| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.534 |\n| 9 | 303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | sparse | 0.527 |\n| 10 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.527 |\n\n\n\n# Complete CWE Specifications\n\n\n## CWE-203: Observable Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n### Extended Description\nDiscrepancies can take many forms, and variations may be detectable in timing, control flow, communications such as replies or requests, or general behavior. These discrepancies can reveal information about the product's operation or internal state to an unauthorized actor. In some cases, discrepancies can be used by attackers to form a side channel.\n\n### Alternative Terms\nSide Channel Attack: Observable Discrepancies are at the root of side channel attacks.\n\n### Relationships\nChildOf -> CWE-200\nChildOf -> CWE-200\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2020-8695:** Observable discrepancy in the RAPL interface for some Intel processors allows information disclosure.\n- **CVE-2019-14353:** Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords\n- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies\n\n\n\n\n## CWE-204: Observable Response Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere.\n\n### Extended Description\nThis issue frequently occurs during authentication, where a difference in failed-login messages could allow an attacker to determine if the username is valid or not. These exposures can be inadvertent (bug) or intentional (design).\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-203\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** can overlap errors related to escalated privileges\n\n\n\n### Observed Examples\n- **CVE-2002-2094:** This, and others, use \"..\" attacks and monitor error responses, so there is overlap with directory traversal.\n- **CVE-2001-1483:** Enumeration of valid usernames based on inconsistent responses\n- **CVE-2001-1528:** Account number enumeration via inconsistent responses.\n\n\n\n\n## CWE-639: Authorization Bypass Through User-Controlled Key\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\n\n### Extended Description\n\n\nRetrieval of a user record occurs in the system based on some key value that is under user control. The key would typically identify a user-related record stored in the system and would be used to lookup that record for presentation to the user. It is likely that an attacker would have to be an authenticated user in the system. However, the authorization process would not properly check the data access operation to ensure that the authenticated user performing the operation has sufficient entitlements to perform the requested data access, hence bypassing any other authorization checks present in the system.\n\n\nFor example, attackers can look at places where user specific data is retrieved (e.g. search screens) and determine whether the key for the item being looked up is controllable externally. The key may be a hidden field in the HTML form field, might be passed as a URL parameter or as an unencrypted cookie variable, then in each of these cases it will be possible to tamper with the key value.\n\n\nOne manifestation of this weakness is when a system uses sequential or otherwise easily-guessable session IDs that would allow one user to easily switch to another user's session and read/modify their data.\n\n\n### Alternative Terms\nInsecure Direct Object Reference / IDOR: The \"Insecure Direct Object Reference\" term, as described in the OWASP Top Ten, is broader than this CWE because it also covers path traversal (CWE-22). Within the context of vulnerability theory, there is a similarity between the OWASP concept and CWE-706: Use of Incorrectly-Resolved Name or Reference.\nBroken Object Level Authorization / BOLA: BOLA is used in the 2019 OWASP API Security Top 10 and is said to be the same as IDOR.\nHorizontal Authorization: \"Horizontal Authorization\" is used to describe situations in which two users have the same privilege level, but must be prevented from accessing each other's resources. This is fairly common when using key-based access to resources in a multi-user context.\n\n### Relationships\nChildOf -> CWE-863\nChildOf -> CWE-863\nChildOf -> CWE-284\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2021-36539:** An educational application does not appropriately restrict file IDs to a particular user. The attacker can brute-force guess IDs, indicating IDOR.\n\n\n\n\n## CWE-863: Incorrect Authorization\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nAuthZ: \"AuthZ\" is typically used as an abbreviation of \"authorization\" within the web application security community. It is distinct from \"AuthN\" (or, sometimes, \"AuthC\") which is an abbreviation of \"authentication.\" The use of \"Auth\" as an abbreviation is discouraged, since it could be used for either authentication or authorization.\n\n### Relationships\nChildOf -> CWE-285\nChildOf -> CWE-284\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n### Additional Notes\n**[Terminology]** \n\nAssuming a user with a given identity, authorization is the process of determining whether that user can access a given resource, based on the user's privileges and any permissions or other access-control specifications that apply to the resource.\n\n\n\n\n### Observed Examples\n- **CVE-2021-39155:** Chain: A microservice integration and management platform compares the hostname in the HTTP Host header in a case-sensitive way (CWE-178, CWE-1289), allowing bypass of the authorization policy (CWE-863) using a hostname with mixed case or other variations.\n- **CVE-2019-15900:** Chain: sscanf() call is used to check if a username and group exists, but the return value of sscanf() call is not checked (CWE-252), causing an uninitialized variable to be checked (CWE-457), returning success to allow authorization bypass for executing a privileged (CWE-863).\n- **CVE-2009-2213:** Gateway uses default \"Allow\" configuration for its authorization settings.\n\n\n\n\n## CWE-613: Insufficient Session Expiration\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nAccording to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\"\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-672\nChildOf -> CWE-672\nCanPrecede -> CWE-287\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Other]** The lack of proper session expiration may improve the likely success of certain attacks. For example, an attacker may intercept a session ID, possibly via a network sniffer or Cross-site Scripting attack. Although short session expiration times do not help if a stolen token is immediately used, they will protect against ongoing replaying of the session ID. In another scenario, a user might access a web site from a shared computer (such as at a library, Internet cafe, or open work environment). Insufficient Session Expiration could allow an attacker to use the browser's back button to access web pages previously accessed by the victim.\n\n\n\n\n\n\n## CWE-286: Incorrect User Management\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product does not properly manage a user within its environment.\n\n### Extended Description\nUsers can be assigned to the wrong group (class) of permissions resulting in unintended access rights to sensitive objects.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-284\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n### Additional Notes\n**[Maintenance]** The relationships between privileges, permissions, and actors (e.g. users and groups) need further refinement within the Research view. One complication is that these concepts apply to two different pillars, related to control of resources (CWE-664) and protection mechanism failures (CWE-693).\n\n**[Maintenance]** This item needs more work. Possible sub-categories include: user in wrong group, and user with insecure profile or \"configuration\". It also might be better expressed as a category than a weakness.\n\n\n\n### Observed Examples\n- **CVE-2022-36109:** Containerization product does not record a user's supplementary group ID, allowing bypass of group restrictions.\n- **CVE-1999-1193:** Operating system assigns user to privileged wheel group, allowing the user to gain root privileges.\n\n\n\n\n## CWE-1275: Sensitive Cookie with Improper SameSite Attribute\n**Abstraction:** Variant\n**Status:** Incomplete\n\n### Description\nThe SameSite attribute for sensitive cookies is not set, or an insecure value is used.\n\n### Extended Description\nThe SameSite attribute controls how cookies are sent for cross-domain requests. This attribute may have three values: 'Lax', 'Strict', or 'None'. If the 'None' value is used, a website may create a cross-domain POST HTTP request to another website, and the browser automatically adds cookies to this request. This may lead to Cross-Site-Request-Forgery (CSRF) attacks if there are no additional protections in place (such as Anti-CSRF tokens).\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-923\nCanPrecede -> CWE-352\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2022-24045:** Web application for a room automation system has client-side JavaScript that sets a sensitive cookie without the SameSite security attribute, allowing the cookie to be sniffed\n\n\n\n\n## CWE-862: Missing Authorization\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product does not perform an authorization check when an actor attempts to access a resource or perform an action.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nAuthZ: \"AuthZ\" is typically used as an abbreviation of \"authorization\" within the web application security community. It is distinct from \"AuthN\" (or, sometimes, \"AuthC\") which is an abbreviation of \"authentication.\" The use of \"Auth\" as an abbreviation is discouraged, since it could be used for either authentication or authorization.\n\n### Relationships\nChildOf -> CWE-285\nChildOf -> CWE-284\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n### Additional Notes\n**[Terminology]** Assuming a user with a given identity, authorization is the process of determining whether that user can access a given resource, based on the user's privileges and any permissions or other access-control specifications that apply to the resource.\n\n\n\n### Observed Examples\n- **CVE-2022-24730:** Go-based continuous deployment product does not check that a user has certain privileges to update or create an app, allowing adversaries to read sensitive repository information\n- **CVE-2009-3168:** Web application does not restrict access to admin scripts, allowing authenticated users to reset administrative passwords.\n- **CVE-2009-3597:** Web application stores database file under the web root with insufficient access control (CWE-219), allowing direct request.\n\n\n\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.\n\n### Extended Description\nThis incorrect implementation may allow authentication to be bypassed.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-1390\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2003-0750:** Conditional should have been an 'or' not an 'and'.\n\n\n\n\n## CWE-209: Generation of Error Message Containing Sensitive Information\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product generates an error message that includes sensitive information about its environment, users, or associated data.\n\n### Extended Description\n\n\nThe sensitive information may be valuable information on its own (such as a password), or it may be useful for launching other, more serious attacks. The error message may be created in different ways:\n\n\n  - self-generated: the source code explicitly constructs the error message and delivers it\n\n  - externally-generated: the external environment, such as a language interpreter, handles the error and constructs its own message, whose contents are not under direct control by the programmer\n\nAn attacker may use the contents of error messages to help launch another, more focused attack. For example, an attempt to exploit a path traversal weakness (CWE-22) might yield the full pathname of the installed application. In turn, this could be used to select the proper number of \"..\" sequences to navigate to the targeted file. An attack using SQL injection (CWE-89) might not initially succeed, but an error message could reveal the malformed query, which would expose query logic and possibly even passwords or other sensitive information used within the query.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-200\nChildOf -> CWE-200\nChildOf -> CWE-755\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2008-2049:** POP3 server reveals a password in an error message after multiple APOP commands are sent. Might be resultant from another weakness.\n- **CVE-2007-5172:** Program reveals password in error message if attacker can trigger certain database errors.\n- **CVE-2008-4638:** Composite: application running with high privileges (CWE-250) allows user to specify a restricted file to process, which generates a parsing error that leaks the contents of the file (CWE-209).\n\n",
  "keyphrases": {},
  "timestamp": "2025-04-02 09:14:27",
  "cve_id": "unknown",
  "result_count": 10,
  "results": [
    {
      "cwe_id": "204",
      "name": "Observable Response Discrepancy",
      "type": "Base",
      "score": 0.7732449563690641
    },
    {
      "cwe_id": "807",
      "name": "Reliance on Untrusted Inputs in a Security Decision",
      "type": "Base",
      "score": 0.7619460039203971
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "type": "Base",
      "score": 0.75172418715991
    },
    {
      "cwe_id": "302",
      "name": "Authentication Bypass by Assumed-Immutable Data",
      "type": "Base",
      "score": 0.7392171199874896
    },
    {
      "cwe_id": "208",
      "name": "Observable Timing Discrepancy",
      "type": "Base",
      "score": 0.7363571366041293
    },
    {
      "cwe_id": "203",
      "name": "Observable Discrepancy",
      "type": "Base",
      "score": 0.7346246959427958
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "type": "Class",
      "score": 0.7334309200829559
    },
    {
      "cwe_id": "1220",
      "name": "Insufficient Granularity of Access Control",
      "type": "Base",
      "score": 0.7320179211091344
    },
    {
      "cwe_id": "668",
      "name": "Exposure of Resource to Wrong Sphere",
      "type": "Class",
      "score": 0.7308878512243036
    },
    {
      "cwe_id": "405",
      "name": "Asymmetric Resource Consumption (Amplification)",
      "type": "Class",
      "score": 0.730315898854071
    }
  ]
}