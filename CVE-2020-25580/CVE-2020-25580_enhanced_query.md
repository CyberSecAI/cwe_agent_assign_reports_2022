# Enhanced Query for CVE-2020-25580

## Vulnerability Description
In FreeBSD 12.2-STABLE before r369346, 11.4-STABLE before r369345, 12.2-RELEASE before p4 and 11.4-RELEASE before p8 a **regression in the login.access(5) rule processor** has the effect of causing rules to fail to match even when they should not. This means that rules denying access may be ignored.

### Vulnerability Description Key Phrases
- **rootcause:** **regression in the login.access(5) rule processor**
- **impact:** rules denying access may be ignored
- **product:** FreeBSD 12.2-STABLE and FreeBSD 11.4-STABLE and FreeBSD 12.2-RELEASE and FreeBSD 11.4-RELEASE
- **version:** before r369346 and before r369345 and before p4 and before p8
- **component:** login.access(5)

## CVE Reference Links Content Summary
```
{
  "CVE-2020-25580": {
    "Metadata": {
      "Cve ID": "CVE-2020-25580",
      "Cve Description": "PLACEHOLDER - Implement CVE description retrieval"
    },
    "Netapp Advisory": {
      "Summary": "Multiple NetApp products incorporate FreeBSD. All supported versions of FreeBSD are susceptible to a vulnerability which when successfully exploited could lead to addition or modification of data.",
      "Impact": "Successful exploitation of this vulnerability could lead to addition or modification of data.",
        "Affected Products": [
            "None."
        ],
        "Unaffected Products": [
            "7-Mode Transition Tool",
            "AFF Baseboard Management Controller (BMC) - A700s",
            "ATTO FibreBridge - 6500N",
            "ATTO FibreBridge - 7500N",
            "ATTO FibreBridge - 7600N",
            "Active IQ Unified Manager for Linux",
            "Active IQ Unified Manager for Microsoft Windows",
            "Active IQ Unified Manager for VMware vSphere",
            "Active IQ mobile app",
            "Brocade Fabric Operating System Firmware",
            "Brocade SAN Navigator (SANnav)",
            "Cloud Insights Telegraf Agent",
            "Cloud Manager",
            "Cloud Volumes ONTAP Mediator",
            "Clustered Data ONTAP",
            "Clustered Data ONTAP Antivirus Connector",
            "E-Series BIOS",
            "E-Series SANtricity OS Controller Baseboard Management Controller (BMC) - EF600A",
            "E-Series SANtricity OS Controller Software 11.x",
            "E-Series SANtricity Storage Manager",
            "E-Series SANtricity Web Services (REST API) for Web Services Proxy",
            "Element .NET SDK",
            "Element HealthTools",
            "Element JAVA SDK",
            "Element Plug-in for vCenter Server",
            "Element Python SDK",
            "FAS/AFF BIOS",
            "FAS/AFF Baseboard Management Controller (BMC)",
            "FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400",
            "FAS/AFF Baseboard Management Controller (BMC) - A250/500f",
            "Host Utilities - SAN for Linux",
            "Host Utilities - SAN for Windows",
            "Inventory Collect Tool",
            "Management Services for Element Software and NetApp HCI",
            "MetroCluster Tiebreaker for clustered Data ONTAP",
            "NetApp Cloud Backup (formerly AltaVault)",
            "NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)",
            "NetApp Converged Systems Advisor Agent",
            "NetApp E-Series Performance Analyzer",
            "NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S",
            "NetApp HCI Baseboard Management Controller (BMC) - H410C",
            "NetApp HCI Baseboard Management Controller (BMC) - H610C",
            "NetApp HCI Baseboard Management Controller (BMC) - H610S",
            "NetApp HCI Baseboard Management Controller (BMC) - H615C",
            "NetApp HCI Compute Node (Bootstrap OS)",
            "NetApp HCI Compute Node BIOS",
            "NetApp HCI Storage Node BIOS",
            "NetApp Manageability SDK",
             "NetApp NFS Plug-in for VMware VAAI",
            "NetApp SANtricity Cloud Connector",
            "NetApp SANtricity SMI-S Provider",
            "NetApp SMI-S Provider",
            "NetApp SolidFire & HCI Management Node",
            "NetApp SolidFire & HCI Storage Node (Element Software)",
            "NetApp SolidFire BIOS",
            "NetApp SolidFire Baseboard Management Controller (BMC)",
            "NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)",
            "NetApp Storage Encryption",
            "NetApp VASA Provider for Clustered Data ONTAP 9.6 and above",
            "NetApp XCP NFS",
            "NetApp XCP SMB",
            "ONTAP Mediator",
            "ONTAP Select Deploy administration utility",
            "OnCommand API Services",
            "OnCommand Insight",
            "OnCommand Unified Manager Core Package",
            "OnCommand Workflow Automation",
            "Open Systems SnapVault Agent",
            "SANtricity Unified Manager",
            "SAS Firmware",
            "SRA Plugin for Linux",
            "SRA Plugin for Windows",
            "Service Processor",
             "Single Mailbox Recovery",
            "Snap Creator Framework",
            "SnapCenter",
            "SnapCenter Plug-in for VMware vSphere",
            "SnapDrive for Unix",
            "SnapDrive for Windows",
            "SnapManager for Exchange",
            "SnapManager for Hyper-V",
            "SnapManager for MS SQL",
            "SnapManager for Oracle",
             "SnapManager for SAP",
            "SnapManager for Sharepoint",
            "SolidFire Storage Replication Adapter",
            "Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.6 and above",
            "Storage Services Connector",
            "StorageGRID (formerly StorageGRID Webscale)",
            "StorageGRID BIOS SG1000/SG100",
             "StorageGRID BIOS SG5660/SG5612/SG5760/SG5712",
            "StorageGRID BIOS SG6060/SGF6024",
            "StorageGRID Baseboard Management Controller (BMC)",
            "StorageGRID9 (9.x and prior)",
            "System Manager 9.x",
            "Trident",
            "Virtual Storage Console for VMware vSphere 9.6 and above"
        ],
      "Workarounds": "None at this time.",
      "CVSS Score": "5.3 (MEDIUM)",
        "CVSS Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
      "References": [
        "https://www.freebsd.org/security/advisories/FreeBSD-SA-21:03.pam_login_access.asc"
      ]
    },
     "FreeBSD Advisory": {
          "Background": "login.access(5) is a system configuration file allowing administrators to define policy around system login access by specific users and groups. It is implemented by a pam(3) module, pam\\_login\\_access(8), and is configured by default for accesses via sshd(8), telnetd(8) and the system console.",
          "Problem Description": "A regression in the login.access(5) rule processor has the effect of causing rules to fail to match even when they should not. This means that rules denying access may be ignored.",
          "Impact": "The configuration in login.access(5) may not be applied, permitting login access to users even when the system is configured to deny it.",
          "Workaround": "No workaround is available. Systems not relying on login.access(5) to enforce custom login policies are not affected.",
         "Solution": "Upgrade your vulnerable system to a supported FreeBSD stable or release / security branch (releng) dated after the correction date."
     },
    "Vulnerability Details": {
      "Root cause": "A regression in the login.access(5) rule processor",
      "Weaknesses": [
        "rules to fail to match even when they should not",
        "rules denying access may be ignored"
      ],
     "Impact": "The configuration in login.access(5) may not be applied, permitting login access to users even when the system is configured to deny it.",
    "Attack vectors": [
      "Accesses via sshd(8), telnetd(8) and the system console."
    ],
      "Required attacker capabilities": "An attacker needs to have some access to system login to exploit this vulnerability."
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 697 | Incorrect Comparison | Pillar | Discouraged | sparse | 0.628 |
| 2 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.360 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.349 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.339 |
| 5 | 243 | Creation of chroot Jail Without Changing Working Directory | Variant | Allowed | sparse | 0.334 |
| 6 | 269 | Improper Privilege Management | Class | Discouraged | dense | 0.472 |
| 7 | 193 | Off-by-one Error | Base | Allowed | graph | 0.002 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.324 |
| 9 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.321 |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.320 |



# Complete CWE Specifications


## CWE-697: Incorrect Comparison
**Abstraction:** Pillar
**Status:** Incomplete

### Description
The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses.

### Extended Description


This Pillar covers several possibilities:


  - the comparison checks one factor incorrectly;

  - the comparison should consider multiple factors, but it does not check at least one of those factors at all;

  - the comparison checks the wrong factor.



### Alternative Terms
None

### Relationships
None

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry is extremely high-level, a Pillar. However, sometimes this weakness is forced to be used due to the lack of in-depth weakness research. See Research Gaps.
**Comments:** Where feasible, consider children or descendants of this entry instead.
**Reasons:**
- Abstraction


### Additional Notes
**[Research Gap]** 

Weaknesses related to this Pillar appear to be under-studied, especially with respect to classification schemes. Input from academic and other communities could help identify and resolve gaps or organizational difficulties within CWE.


**[Maintenance]** This entry likely has some relationships with case sensitivity (CWE-178), but case sensitivity is a factor in other types of weaknesses besides comparison. Also, in cryptography, certain attacks are possible when certain comparison operations do not take place in constant time, causing a timing-related information leak (CWE-208).



### Observed Examples
- **CVE-2021-3116:** Chain: Python-based HTTP Proxy server uses the wrong boolean operators (CWE-480) causing an incorrect comparison (CWE-697) that identifies an authN failure if all three conditions are met instead of only one, allowing bypass of the proxy authentication (CWE-1390)
- **CVE-2020-15811:** Chain: Proxy uses a substring search instead of parsing the Transfer-Encoding header (CWE-697), allowing request splitting (CWE-113) and cache poisoning
- **CVE-2016-10003:** Proxy performs incorrect comparison of request headers, leading to infoleak




## CWE-909: Missing Initialization of Resource
**Abstraction:** Class
**Status:** Incomplete

### Description
The product does not initialize a critical resource.

### Extended Description
Many resources require initialization before they can be properly used. If a resource is not initialized, it could contain unpredictable or expired data, or it could be initialized to defaults that are invalid. This can have security implications when the resource is expected to have certain properties or values.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-665
ChildOf -> CWE-665
CanPrecede -> CWE-908

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction



### Observed Examples
- **CVE-2020-20739:** A variable that has its value set in a conditional statement is sometimes used when the conditional fails, sometimes causing data leakage
- **CVE-2005-1036:** Chain: Bypass of access restrictions due to improper authorization (CWE-862) of a user results from an improperly initialized (CWE-909) I/O permission bitmap




## CWE-863: Incorrect Authorization
**Abstraction:** Class
**Status:** Incomplete

### Description
The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.

### Extended Description
Not provided

### Alternative Terms
AuthZ: "AuthZ" is typically used as an abbreviation of "authorization" within the web application security community. It is distinct from "AuthN" (or, sometimes, "AuthC") which is an abbreviation of "authentication." The use of "Auth" as an abbreviation is discouraged, since it could be used for either authentication or authorization.

### Relationships
ChildOf -> CWE-285
ChildOf -> CWE-284

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction


### Additional Notes
**[Terminology]** 

Assuming a user with a given identity, authorization is the process of determining whether that user can access a given resource, based on the user's privileges and any permissions or other access-control specifications that apply to the resource.




### Observed Examples
- **CVE-2021-39155:** Chain: A microservice integration and management platform compares the hostname in the HTTP Host header in a case-sensitive way (CWE-178, CWE-1289), allowing bypass of the authorization policy (CWE-863) using a hostname with mixed case or other variations.
- **CVE-2019-15900:** Chain: sscanf() call is used to check if a username and group exists, but the return value of sscanf() call is not checked (CWE-252), causing an uninitialized variable to be checked (CWE-457), returning success to allow authorization bypass for executing a privileged (CWE-863).
- **CVE-2009-2213:** Gateway uses default "Allow" configuration for its authorization settings.




## CWE-1390: Weak Authentication
**Abstraction:** Class
**Status:** Incomplete

### Description
The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.

### Extended Description


Attackers may be able to bypass weak authentication faster and/or with less effort than expected.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-287

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction



### Observed Examples
- **CVE-2022-30034:** Chain: Web UI for a Python RPC framework does not use regex anchors to validate user login emails (CWE-777), potentially allowing bypass of OAuth (CWE-1390).
- **CVE-2022-35248:** Chat application skips validation when Central Authentication Service (CAS) is enabled, effectively removing the second factor from two-factor authentication
- **CVE-2021-3116:** Chain: Python-based HTTP Proxy server uses the wrong boolean operators (CWE-480) causing an incorrect comparison (CWE-697) that identifies an authN failure if all three conditions are met instead of only one, allowing bypass of the proxy authentication (CWE-1390)




## CWE-243: Creation of chroot Jail Without Changing Working Directory
**Abstraction:** Variant
**Status:** Draft

### Description
The product uses the chroot() system call to create a jail, but does not change the working directory afterward. This does not prevent access to files outside of the jail.

### Extended Description
Improper use of chroot() may allow attackers to escape from the chroot jail. The chroot() function call does not change the process's current working directory, so relative paths may still refer to file system resources outside of the chroot jail after chroot() has been called.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-573
ChildOf -> CWE-669

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use






## CWE-269: Improper Privilege Management
**Abstraction:** Class
**Status:** Draft

### Description
The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-284

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-269 is commonly misused. It can be conflated with "privilege escalation," which is a technical impact that is listed in many low-information vulnerability reports [REF-1287]. It is not useful for trend analysis.
**Comments:** If an error or mistake allows privilege escalation, then use the CWE ID for that mistake. Avoid using CWE-269 when only phrases such as "privilege escalation" or "gain privileges" are available, as these indicate technical impact of the vulnerability - not the root cause weakness. If the root cause seems to be directly related to privileges, then examine the children of CWE-269 for additional hints, such as Execution with Unnecessary Privileges (CWE-250) or Incorrect Privilege Assignment (CWE-266).
**Reasons:**
- Frequent Misuse


### Additional Notes
**[Maintenance]** The relationships between privileges, permissions, and actors (e.g. users and groups) need further refinement within the Research view. One complication is that these concepts apply to two different pillars, related to control of resources (CWE-664) and protection mechanism failures (CWE-693).



### Observed Examples
- **CVE-2001-1555:** Terminal privileges are not reset when a user logs out.
- **CVE-2001-1514:** Does not properly pass security context to child processes in certain cases, allows privilege escalation.
- **CVE-2001-0128:** Does not properly compute roles.




## CWE-193: Off-by-one Error
**Abstraction:** Base
**Status:** Draft

### Description
A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value.

### Extended Description
Not provided

### Alternative Terms
off-by-five: An "off-by-five" error was reported for sudo in 2002 (CVE-2002-0184), but that is more like a "length calculation" error.

### Relationships
ChildOf -> CWE-682
ChildOf -> CWE-682
CanPrecede -> CWE-617
CanPrecede -> CWE-170
CanPrecede -> CWE-119

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** This is not always a buffer overflow. For example, an off-by-one error could be a factor in a partial comparison, a read from the wrong memory location, an incorrect conditional, etc.



### Observed Examples
- **CVE-2003-0252:** Off-by-one error allows remote attackers to cause a denial of service and possibly execute arbitrary code via requests that do not contain newlines.
- **CVE-2001-1391:** Off-by-one vulnerability in driver allows users to modify kernel memory.
- **CVE-2002-0083:** Off-by-one error allows local users or remote malicious servers to gain privileges.




## CWE-201: Insertion of Sensitive Information Into Sent Data
**Abstraction:** Base
**Status:** Draft

### Description
The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-200
CanAlsoBe -> CWE-209
CanAlsoBe -> CWE-202

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Other]** Sensitive information could include data that is sensitive in and of itself (such as credentials or private messages), or otherwise useful in the further exploitation of the system (such as internal file system structure).



### Observed Examples
- **CVE-2022-0708:** Collaboration platform does not clear team emails in a response, allowing leak of email addresses




## CWE-287: Improper Authentication
**Abstraction:** Class
**Status:** Draft

### Description
When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.

### Extended Description
Not provided

### Alternative Terms
authentification: An alternate term is "authentification", which appears to be most commonly used by people from non-English-speaking countries.
AuthN: "AuthN" is typically used as an abbreviation of "authentication" within the web application security community. It is also distinct from "AuthZ," which is an abbreviation of "authorization." The use of "Auth" as an abbreviation is discouraged, since it could be used for either authentication or authorization.
AuthC: "AuthC" is used as an abbreviation of "authentication," but it appears to used less frequently than "AuthN."

### Relationships
ChildOf -> CWE-284
ChildOf -> CWE-284

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).
**Comments:** Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.
**Reasons:**
- Frequent Misuse
**Suggested Alternatives:**
- CWE-1390: Weak Authentication
- CWE-306: Missing Authentication for Critical Function


### Additional Notes
**[Relationship]** This can be resultant from SQL injection vulnerabilities and other issues.

**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2022-35248:** Chat application skips validation when Central Authentication Service (CAS) is enabled, effectively removing the second factor from two-factor authentication
- **CVE-2022-36436:** Python-based authentication proxy does not enforce password authentication during the initial handshake, allowing the client to bypass authentication by specifying a 'None' authentication type.
- **CVE-2022-30034:** Chain: Web UI for a Python RPC framework does not use regex anchors to validate user login emails (CWE-777), potentially allowing bypass of OAuth (CWE-1390).




## CWE-1284: Improper Validation of Specified Quantity in Input
**Abstraction:** Base
**Status:** Incomplete

### Description
The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.

### Extended Description


Specified quantities include size, length, frequency, price, rate, number of operations, time, and others. Code may rely on specified quantities to allocate resources, perform calculations, control iteration, etc. When the quantity is not properly validated, then attackers can specify malicious quantities to cause excessive resource allocation, trigger unexpected failures, enable buffer overflows, etc.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-20
ChildOf -> CWE-20
CanPrecede -> CWE-789

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Maintenance]** This entry is still under development and will continue to see updates and content improvements.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2008-1440:** lack of validation of length field leads to infinite loop
- **CVE-2008-2374:** lack of validation of string length fields allows memory consumption or buffer over-read

